(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[    100857,       2397]
NotebookOptionsPosition[     87326,       2083]
NotebookOutlinePosition[     87748,       2101]
CellTagsIndexPosition[     87705,       2098]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Nonstationary simulation, human metabolic network", "Title",
 CellChangeTimes->{{3.499323769571*^9, 3.499323774216*^9}, {
   3.5769022998092556`*^9, 3.5769023084952555`*^9}, {3.5799317070895405`*^9, 
   3.5799317102005405`*^9}, {3.6113724357208467`*^9, 3.611372462128487*^9}, {
   3.6114774860233116`*^9, 3.611477486973407*^9}, {3.6124219901360464`*^9, 
   3.6124219924870462`*^9}, {3.6129330786306562`*^9, 3.612933083220115*^9}, {
   3.6210656953223553`*^9, 3.6210657189067135`*^9}, 3.632898091383972*^9, {
   3.646295665081069*^9, 3.6462956757613187`*^9}, {3.657791345850931*^9, 
   3.6577913505641317`*^9}, {3.6581366053106155`*^9, 
   3.6581366062676153`*^9}, {3.6775822643279657`*^9, 
   3.6775822705750465`*^9}, {3.7893638576642*^9, 3.7893638685596247`*^9}, {
   3.833426899479867*^9, 3.833426905381212*^9}, {3.8733359563165054`*^9, 
   3.87333595876711*^9}, {3.9011221730809865`*^9, 3.901122174489498*^9}, {
   3.941854319694481*^9, 
   3.941854322504922*^9}},ExpressionUUID->"a07bb2d6-24fa-41bf-8eb9-\
97e0b44fe4ff"],

Cell[TextData[{
 "This notebook requires the ",
 StyleBox["mathcompbio", "Input"],
 " package, available from https://github.com/Nilsson-Lab-KI/mathcompbio\nSet \
the below path to point to the ",
 StyleBox["mathcompbio", "Input"],
 " package directory."
}], "Text",
 CellChangeTimes->{{3.941854335875453*^9, 3.94185434416527*^9}, {
  3.941854383719139*^9, 3.9418544687243805`*^9}, {3.9418545824345856`*^9, 
  3.941854589275832*^9}},ExpressionUUID->"1000efa5-1f1f-48df-9f9b-\
844d7613cbc0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mathcompbioPath", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"\"\<C:\>\"", ",", "\"\<code\>\"", ",", "\"\<mathcompbio\>\""}], 
     "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.941854470686699*^9, 3.941854492384163*^9}, {
   3.941854566804315*^9, 3.941854567884598*^9}, {3.9418545982544394`*^9, 
   3.941854630734314*^9}, 3.9418547000046124`*^9, 3.9418552149836693`*^9, {
   3.9418552669136643`*^9, 
   3.9418552810429125`*^9}},ExpressionUUID->"5f956496-50c3-4d34-971c-\
99c6e8f7822b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"$Path", ",", "mathcompbioPath"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.941854470686699*^9, 3.941854492384163*^9}, {
   3.941854566804315*^9, 3.941854567884598*^9}, {3.9418545982544394`*^9, 
   3.941854630734314*^9}, 3.9418547000046124`*^9, 3.9418552149836693`*^9, {
   3.9418552669136643`*^9, 
   3.9418552897838383`*^9}},ExpressionUUID->"55123894-b5b4-4dd1-997b-\
583292c9f222"],

Cell[BoxData[{
 RowBox[{"<<", "NilssonLab`MetabolicNetwork`Common`"}], "\n", 
 RowBox[{"<<", "NilssonLab`IsotopeDistributions`"}], "\n", 
 RowBox[{"<<", "NilssonLab`AtomMap`Common`"}], "\n", 
 RowBox[{"<<", "NilssonLab`EMUTracing`"}], "\n", 
 RowBox[{"<<", "NilssonLab`GAMSFluxEstimation`"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "NilssonLab`Visualization`"}]}], "Input",
 CellChangeTimes->{{3.5771976609262695`*^9, 3.5771976617632694`*^9}, {
   3.5781318201587696`*^9, 3.5781318223027697`*^9}, 3.579941928598714*^9, 
   3.5804852976937556`*^9, {3.5975687160611534`*^9, 3.5975687167891536`*^9}, 
   3.611312353293462*^9, 3.611461569036772*^9, 3.611477479822692*^9, 
   3.61293309417321*^9, 3.618128293999797*^9, {3.619441922314502*^9, 
   3.6194419228655567`*^9}, 3.621140196757456*^9, 3.6329981116816063`*^9, 
   3.6334179216376123`*^9, 3.6585719316577682`*^9, 3.658638162808116*^9, {
   3.6622658425458565`*^9, 3.662265842951457*^9}, 3.67764857296754*^9, 
   3.6776501089892874`*^9, {3.941854672674469*^9, 3.9418546741944647`*^9}, {
   3.9418553007034264`*^9, 3.941855303333731*^9}, {3.9418556788026094`*^9, 
   3.9418556976327744`*^9}},ExpressionUUID->"8b0b154a-4f30-41a5-abf8-\
1c38f42be304"],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.9418553176879225`*^9, 
  3.9418553447637367`*^9}},ExpressionUUID->"f189ba21-c51a-4651-9218-\
17a62979063f"],

Cell["Conserve some memory", "Text",
 CellChangeTimes->{{3.9418548282342787`*^9, 
  3.9418548344038906`*^9}},ExpressionUUID->"c1c31270-c7db-40c1-a52a-\
4b84fe32b3ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$HistoryLength", "=", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.9011695654351687`*^9, 3.901169594420535*^9}, {
   3.9011697572940845`*^9, 3.901169757410697*^9}, 
   3.901170489447029*^9},ExpressionUUID->"9cf77950-7f2b-4e24-8108-\
ead026b859cd"],

Cell[CellGroupData[{

Cell["Human network model", "Section",
 CellChangeTimes->{{3.499456116034768*^9, 3.499456119513574*^9}, {
  3.5794118623793745`*^9, 3.5794118646583743`*^9}, {3.6152700622557683`*^9, 
  3.615270068798768*^9}, {3.9418554926634808`*^9, 
  3.941855492962628*^9}},ExpressionUUID->"2f4a18e5-4034-4422-b0f1-\
f8412fd3800b"],

Cell[CellGroupData[{

Cell["Stoichiometry", "Subsection",
 CellChangeTimes->{{3.941858280449153*^9, 
  3.9418582877195225`*^9}},ExpressionUUID->"79ec9a5b-981d-4a78-8d76-\
b29d23428ca0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Get", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"\"\<network-model\>\"", ",", "\"\<net.m\>\""}], "}"}], "]"}], 
   "]"}], ";"}], "\[IndentingNewLine]", "net"}], "Input",
 CellChangeTimes->{{3.499323834406*^9, 3.499323852743*^9}, {
   3.4994311919848804`*^9, 3.4994311920461206`*^9}, 3.4994550985229807`*^9, {
   3.5794119039713745`*^9, 3.5794119414663744`*^9}, {3.5794119780093746`*^9, 
   3.5794120134483747`*^9}, {3.5794123828283744`*^9, 
   3.5794124186673746`*^9}, {3.5794124544223747`*^9, 
   3.5794124708793745`*^9}, {3.5799318424875402`*^9, 
   3.5799320013645406`*^9}, {3.5799320323155403`*^9, 
   3.5799320359095407`*^9}, {3.5839284507735467`*^9, 
   3.5839284569801674`*^9}, {3.5975704220441537`*^9, 3.597570531043154*^9}, {
   3.5980802888304076`*^9, 3.598080335038028*^9}, 3.6775823640602674`*^9, 
   3.6857805170811443`*^9, {3.6857805707043943`*^9, 3.6857806699266443`*^9}, {
   3.6878432181247463`*^9, 3.687843224355844*^9}, 3.9007451437560444`*^9, {
   3.900745176372035*^9, 3.9007451770756173`*^9}, {3.9418552021232185`*^9, 
   3.9418552027839513`*^9}, {3.941855374833294*^9, 3.9418554226636405`*^9}, {
   3.941855477763127*^9, 3.9418554845629654`*^9}, 
   3.941858284739546*^9},ExpressionUUID->"7b6809bc-9800-4f4f-919f-\
24a12b2bcbd6"],

Cell["\<\
Stochiometry matrix (metabolites x reactions) for the reversible network\
\>", "Text",
 CellChangeTimes->{{3.499351171144*^9, 3.49935119223*^9}, {
  3.5794122243423743`*^9, 3.5794122325093746`*^9}, {3.6463005323875685`*^9, 
  3.6463005332673187`*^9}},ExpressionUUID->"f3894926-7f38-4527-b76d-\
235106db43fc"],

Cell[BoxData[
 RowBox[{"MatrixPlot", "[", 
  RowBox[{"Stoichiometry", "[", "net", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.4993511772539997`*^9, 3.499351317359*^9}, 
   3.499451418111123*^9, {3.579412243859374*^9, 3.5794122473543744`*^9}, {
   3.5794123198793745`*^9, 3.5794123258533745`*^9}, 3.579412406784374*^9, {
   3.5794124772903748`*^9, 3.5794124834083743`*^9}, {3.579942425465263*^9, 
   3.5799424281460667`*^9}, {3.5980800718207088`*^9, 3.598080081877714*^9}, {
   3.611372517444018*^9, 3.611372518622136*^9}, {3.618132828392191*^9, 
   3.6181328318645377`*^9}, {3.677582375285812*^9, 3.6775824059142094`*^9}, {
   3.687843234698608*^9, 
   3.687843242592733*^9}},ExpressionUUID->"d48b3d7a-f082-4229-9555-\
364c3266b73d"],

Cell["Generate boundary network (uptake and release fluxes)", "Text",
 CellChangeTimes->{{3.6152700873097687`*^9, 3.6152700930377684`*^9}, {
  3.658137599927415*^9, 3.6581376152066154`*^9}, {3.9418555569533234`*^9, 
  3.9418555694331803`*^9}},ExpressionUUID->"fd2e36ff-f5d6-48ab-aa14-\
d841b44dd110"],

Cell[BoxData[
 RowBox[{"bnet", "=", 
  RowBox[{"BoundaryNetwork", "[", "net", "]"}]}]], "Input",
 CellChangeTimes->{{3.5982580149633164`*^9, 
  3.5982580274493165`*^9}},ExpressionUUID->"af19f68d-caaf-4bbc-8024-\
81baccbf7602"]
}, Closed]],

Cell[CellGroupData[{

Cell["Ratio-balanced flux vector", "Subsection",
 CellChangeTimes->{{3.678187667952057*^9, 
  3.6781876747848573`*^9}},ExpressionUUID->"a0e55e63-87c3-479e-9da8-\
c84b873d810e"],

Cell[BoxData[
 RowBox[{"trueFlux", "=", 
  RowBox[{"ReadFluxState", "[", 
   RowBox[{"\"\<balanced-ratios_fluxopt.tsv\>\"", ",", "net", ",", 
    RowBox[{"EMUFluxMap", "[", "net", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.678001441911006*^9, 3.6780014564990063`*^9}, {
   3.678001728258206*^9, 3.6780017370274057`*^9}, 3.8540109267956743`*^9, {
   3.8540110950510397`*^9, 3.8540110991236544`*^9}, {3.854011155300071*^9, 
   3.85401116742032*^9}, {3.90074547890278*^9, 3.900745500560607*^9}, 
   3.9418555914029255`*^9, {3.941855739772191*^9, 3.941855772382871*^9}, {
   3.9418558933627267`*^9, 3.941855897417365*^9}, {3.9418565336617994`*^9, 
   3.9418565484314923`*^9}},ExpressionUUID->"9632d601-8a30-4136-aa32-\
df8e27fe21a3"]
}, Closed]],

Cell[CellGroupData[{

Cell["Atom map", "Subsection",
 CellChangeTimes->{{3.617872170201542*^9, 3.6178721746631703`*^9}, {
   3.6775825662857003`*^9, 3.6775825694595413`*^9}, 
   3.9418566493096457`*^9},ExpressionUUID->"8b2a8203-ec6f-4804-8abe-\
8752b241526f"],

Cell["All atom transitions for reactions in model", "Text",
 CellChangeTimes->{{3.6178706359372826`*^9, 3.6178706431288824`*^9}, {
  3.6178707466348825`*^9, 
  3.6178707509872828`*^9}},ExpressionUUID->"b825bfa5-82f8-4840-bf38-\
03aef6e19d37"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Get", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"\"\<network-model\>\"", ",", "\"\<atomMap.m\>\""}], "}"}], 
    "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "atomMap", "]"}]}], "Input",
 CellChangeTimes->{{3.5771692167802677`*^9, 3.5771692171872673`*^9}, {
   3.577171238634268*^9, 3.5771712394412675`*^9}, 3.5771743414402676`*^9, 
   3.597847669695359*^9, 3.597849401247749*^9, 3.597908190884599*^9, 
   3.597909228741599*^9, 3.5979098719685993`*^9, 3.599046400289027*^9, 
   3.607159543903122*^9, {3.615640070382162*^9, 3.615640071944162*^9}, {
   3.6178707038284826`*^9, 3.617870704811282*^9}, {3.6213394493958855`*^9, 
   3.6213394601809635`*^9}, {3.646301404810319*^9, 3.6463014056823187`*^9}, 
   3.658140541949315*^9, {3.658487332799675*^9, 3.658487343377675*^9}, {
   3.6775825784648576`*^9, 3.677582579791875*^9}, 3.677582846595523*^9, {
   3.6778464234459257`*^9, 3.677846527833926*^9}, {3.677846624831726*^9, 
   3.677846630152326*^9}, {3.6878436940742283`*^9, 3.687843708239538*^9}, {
   3.6878437453216143`*^9, 3.687843747732848*^9}, {3.687843851890857*^9, 
   3.6878438532802663`*^9}, {3.6878443423429203`*^9, 3.6878443530087857`*^9}, 
   3.9007455630379567`*^9, {3.94185680014027*^9, 
   3.941856816988718*^9}},ExpressionUUID->"35a9a7cd-c087-47a6-8351-\
a42e49099765"],

Cell["Cretate boundary atom maps (uptake / release)", "Text",
 CellChangeTimes->{{3.5990537792350087`*^9, 3.5990537825710087`*^9}, 
   3.6071595441711483`*^9, {3.6152948921011453`*^9, 3.615294894277363*^9}, {
   3.6585709808552804`*^9, 
   3.6585709866772804`*^9}},ExpressionUUID->"6acea234-a9f6-41bb-be72-\
3184d8acd39d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bmap", "=", 
   RowBox[{"BoundaryAtomMaps", "[", 
    RowBox[{"net", ",", "atomMap"}], "]"}]}], ";"}], "\n", 
 RowBox[{"Length", "[", "bmap", "]"}]}], "Input",
 CellChangeTimes->{{3.5990537841060085`*^9, 3.5990537936040087`*^9}, 
   3.6052404474029603`*^9, 3.6071595441711483`*^9, {3.9418568477304993`*^9, 
   3.9418568522679205`*^9}},ExpressionUUID->"68ddcf95-54b3-4244-a167-\
390f83de996f"],

Cell["Molecular symmetry", "Text",
 CellChangeTimes->{{3.941857051821848*^9, 
  3.941857060131357*^9}},ExpressionUUID->"5b095489-0c26-4fe3-bc8a-\
b7d4e76c367a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Get", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"\"\<network-model\>\"", ",", "\"\<symmetry.m\>\""}], "}"}], 
    "]"}], "]"}], ";"}], "\[IndentingNewLine]", "symmetry"}], "Input",
 CellChangeTimes->{{3.5771692167802677`*^9, 3.5771692171872673`*^9}, {
   3.577171238634268*^9, 3.5771712394412675`*^9}, 3.5771743414402676`*^9, 
   3.597847669695359*^9, 3.597849401247749*^9, 3.597908190884599*^9, 
   3.597909228741599*^9, 3.5979098719685993`*^9, 3.599046400289027*^9, 
   3.607159543903122*^9, {3.615640070382162*^9, 3.615640071944162*^9}, {
   3.6178707038284826`*^9, 3.617870704811282*^9}, {3.6213394493958855`*^9, 
   3.6213394601809635`*^9}, {3.646301404810319*^9, 3.6463014056823187`*^9}, 
   3.658140541949315*^9, {3.658487332799675*^9, 3.658487343377675*^9}, {
   3.6775825784648576`*^9, 3.677582579791875*^9}, 3.677582846595523*^9, {
   3.6778464234459257`*^9, 3.677846527833926*^9}, {3.677846624831726*^9, 
   3.677846630152326*^9}, {3.6878436940742283`*^9, 3.687843708239538*^9}, {
   3.6878437453216143`*^9, 3.687843747732848*^9}, {3.687843851890857*^9, 
   3.6878438532802663`*^9}, {3.6878443423429203`*^9, 3.6878443530087857`*^9}, 
   3.9007455630379567`*^9, {3.94185680014027*^9, 3.941856816988718*^9}, {
   3.941857129231329*^9, 
   3.941857136171282*^9}},ExpressionUUID->"1f3cd015-2c36-4f3f-8025-\
90299c18d849"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["EMU model", "Section",
 CellChangeTimes->{{3.6774727996335692`*^9, 
  3.677472801267991*^9}},ExpressionUUID->"235fc02c-358b-4b95-bdb0-\
d0a9b151526d"],

Cell[CellGroupData[{

Cell["EMU targets to simulate", "Subsection",
 CellChangeTimes->{{3.6152663155225687`*^9, 3.6152663202493687`*^9}, {
   3.6152698641637683`*^9, 3.615269869539768*^9}, {3.6330005380812063`*^9, 
   3.633000542488806*^9}, 3.6774160466250887`*^9, {3.8540113212597227`*^9, 
   3.8540113217303653`*^9}, {3.94185715747152*^9, 
   3.9418571749614534`*^9}},ExpressionUUID->"2b11aa43-83ea-4e3a-ac86-\
f139f39a3f7f"],

Cell["Simulate all metabolites", "Text",
 CellChangeTimes->{{3.94185717673133*^9, 
  3.941857199461506*^9}},ExpressionUUID->"e61e5192-7f4b-4645-812c-\
5e7e602942c5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"targets", "=", 
   RowBox[{"MetaboliteEMUs", "[", "atomMap", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"targets", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.854011326409785*^9, 3.8540113550671234`*^9}, {
  3.8540113871700554`*^9, 
  3.8540114177100058`*^9}},ExpressionUUID->"faab4f84-fa29-462f-9b7d-\
cf2660af64e6"]
}, Closed]],

Cell[CellGroupData[{

Cell["Run the EMU decomposition algorithm", "Subsection",
 CellChangeTimes->{{3.5771927320672693`*^9, 3.5771927399472694`*^9}, 
   3.607159544371168*^9},ExpressionUUID->"6547c4ec-5522-4f3a-86ea-\
c0ffc79166a5"],

Cell["\<\
Find EMU reactions over all carbons (this takes a few minutes)\
\>", "Text",
 CellChangeTimes->{{3.615270740211768*^9, 3.6152707497067685`*^9}, {
  3.6780175860930533`*^9, 3.6780175892764535`*^9}, {3.9418572097913027`*^9, 
  3.9418572184608974`*^9}, {3.941857657390074*^9, 
  3.9418576642500525`*^9}},ExpressionUUID->"379137ff-dc14-4205-b45d-\
592081a55b1d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"emuReactions", "=", 
   RowBox[{"EMUAlgorithm", "[", 
    RowBox[{"net", ",", "atomMap", ",", "bmap", ",", 
     RowBox[{"{", "\"\<C\>\"", "}"}], ",", "targets", ",", "symmetry"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{"Length", "[", "emuReactions", "]"}]}], "Input",
 CellChangeTimes->{{3.577192683689269*^9, 3.5771926977522693`*^9}, 
   3.577194331873269*^9, {3.599046895544752*^9, 3.5990468959007874`*^9}, {
   3.601726953843271*^9, 3.601726954604347*^9}, {3.601818177910904*^9, 
   3.6018182002561383`*^9}, 3.607159544371168*^9, {3.61295757899865*^9, 
   3.6129576015439043`*^9}, {3.6152707076157684`*^9, 
   3.6152707080077686`*^9}, {3.6194364289822235`*^9, 
   3.6194364392872534`*^9}, {3.621069976570555*^9, 3.621069977568555*^9}, 
   3.6774858673090467`*^9, {3.677487267462919*^9, 3.6774872677749233`*^9}, 
   3.677851506931835*^9, {3.8736895506651373`*^9, 3.8736895788381524`*^9}, {
   3.8736896972897787`*^9, 3.8736897000826044`*^9}, {3.873689983409545*^9, 
   3.8736899850308256`*^9}},ExpressionUUID->"0e6de91d-7580-4089-9105-\
3c7816650b76"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"emuReactionNames", "=", 
   RowBox[{"EMUFluxMap", "[", 
    RowBox[{"net", ",", "\"\<reactions\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "emuReactionNames", "]"}]}], "Input",
 CellChangeTimes->{{3.677487409623147*^9, 3.677487419502074*^9}, {
  3.6774874509618807`*^9, 3.6774874533653116`*^9}, {3.677487528471675*^9, 
  3.6774875489013376`*^9}, {3.941857972622324*^9, 
  3.9418579727702017`*^9}},ExpressionUUID->"e4e68454-3b63-47e2-a2ef-\
958f855aa2cd"],

Cell["Number of EMUs", "Text",
 CellChangeTimes->{{3.615270740211768*^9, 
  3.6152707421957684`*^9}},ExpressionUUID->"fefd05f6-4e78-4fa9-a2de-\
1e55f0509be7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"emus", "=", 
   RowBox[{"Union", "[", 
    RowBox[{"Cases", "[", 
     RowBox[{"emuReactions", ",", 
      RowBox[{
       RowBox[{"EMUReaction", "[", 
        RowBox[{"_", ",", "_", ",", "e_EMU", ",", "_"}], "]"}], "\[Rule]", 
       "e"}]}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{"emus", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.5771929850912695`*^9, 3.577192996168269*^9}, 
   3.607159544375169*^9, {3.6194367694822702`*^9, 3.619436769602282*^9}, {
   3.6210688950730553`*^9, 
   3.621068950426055*^9}},ExpressionUUID->"53ee85b9-e9ef-4b7e-a436-\
a36357f575f7"],

Cell["Verify all targets are included", "Text",
 CellChangeTimes->{{3.854074682332224*^9, 3.8540746857698264`*^9}, {
  3.941857676869961*^9, 
  3.941857678090926*^9}},ExpressionUUID->"ee276756-cdfb-48ce-b2e3-\
bbcac68fc405"],

Cell[BoxData[
 RowBox[{"Complement", "[", 
  RowBox[{"targets", ",", "emus"}], "]"}]], "Input",
 CellChangeTimes->{{3.5801051655482454`*^9, 3.5801051687862453`*^9}, 
   3.5946501128280888`*^9, 
   3.6071595443761687`*^9},ExpressionUUID->"0dbec32c-364f-4ffe-9b18-\
20fb8045a343"],

Cell["Total number of variables in the model (MI fractions)", "Text",
 CellChangeTimes->{{3.612957778445593*^9, 3.612957783749123*^9}, {
  3.6779212024742155`*^9, 3.6779212162374153`*^9}, {3.941857687439897*^9, 
  3.9418576882901015`*^9}},ExpressionUUID->"b3c187ec-861a-44d3-b0ee-\
3af35ee335f1"],

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Times", "@@", "#"}], "&"}], ")"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Dimensions", "/@", "emus"}], ")"}], "+", "1"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.612945015442218*^9, 3.6129450585405273`*^9}, {
  3.6129574437481265`*^9, 3.612957444514203*^9}, {3.6129577885596037`*^9, 
  3.612957788836632*^9}},ExpressionUUID->"b8a67b6f-4d0f-4e5d-960d-\
b1c9e4882d60"],

Cell["TEMPORARY", "Text",
 CellChangeTimes->{{3.9418595188680663`*^9, 
  3.941859546887399*^9}},ExpressionUUID->"31e464ac-6956-485d-ba38-\
c9d0b797cc43"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DumpSave", "[", 
   RowBox[{"\"\<emuReactions.mx\>\"", ",", "emuReactions"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.941859521732257*^9, 3.9418595438071585`*^9}, 
   3.9418598636571693`*^9},ExpressionUUID->"b3d0c2a6-3a05-48cf-b50e-\
6a99f194dcd9"]
}, Closed]],

Cell[CellGroupData[{

Cell["Generate EMU equation systems", "Subsection",
 CellChangeTimes->{{3.577196957562269*^9, 3.577196964642269*^9}, 
   3.6071595443761687`*^9, {3.9418577028998947`*^9, 
   3.9418577031902075`*^9}},ExpressionUUID->"43c72176-d331-4d6c-b081-\
b73788094d4a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"emuEq", "=", 
   RowBox[{"EMUSystem", "[", 
    RowBox[{"emuReactions", ",", 
     RowBox[{"NumberOfFluxes", "[", 
      RowBox[{"EMUFluxMap", "[", "net", "]"}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.5771938520772696`*^9, 3.577193856165269*^9}, {
   3.577195198505269*^9, 3.5771952034332695`*^9}, {3.5771958645012693`*^9, 
   3.5771958652192693`*^9}, 3.579952605741719*^9, 3.5799526450796523`*^9, {
   3.579953459107047*^9, 3.579953460467183*^9}, {3.5803824238265657`*^9, 
   3.580382431753566*^9}, {3.5982722196393166`*^9, 3.5982722626743164`*^9}, {
   3.5982723035713167`*^9, 3.5982723157223167`*^9}, {3.599043617966575*^9, 
   3.5990436182406025`*^9}, {3.599046982061403*^9, 3.599046982223419*^9}, {
   3.6018192177158747`*^9, 3.601819219387041*^9}, {3.601819433781479*^9, 
   3.6018194338594866`*^9}, 3.601900904019269*^9, 3.6071595443771687`*^9, {
   3.6152707629317684`*^9, 3.6152707653337684`*^9}, 
   3.6332596046673527`*^9},ExpressionUUID->"3291fa11-04c5-44a7-a5d0-\
739669a6e8f3"],

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{"emuEq", ",", 
   RowBox[{"TableHeadings", "\[Rule]", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.633259609063953*^9, 
  3.633259618750353*^9}},ExpressionUUID->"aa60d42c-a34f-412d-827c-\
6479bf45e95c"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Labeled substrates", "Section",
 CellChangeTimes->{{3.499329833326*^9, 3.499329842675*^9}, {3.499329875414*^9,
    3.499329878158*^9}, {3.532949677649987*^9, 3.532949683681237*^9}, {
   3.5786454880073433`*^9, 3.5786454893193436`*^9}, 3.6071595443811693`*^9, {
   3.615272828424222*^9, 3.615272859937373*^9}, {3.9418596613568273`*^9, 
   3.9418596741817904`*^9}},ExpressionUUID->"a6538c06-62b2-4eb9-b2a0-\
ff935b012d35"],

Cell[CellGroupData[{

Cell["Substrates and simulations", "Subsection",
 CellChangeTimes->{{3.941859691756838*^9, 
  3.9418596999673386`*^9}},ExpressionUUID->"63558677-2c91-4a59-afff-\
95f3941aaab6"],

Cell[BoxData[
 RowBox[{"substrates", "=", 
  RowBox[{"Cases", "[", 
   RowBox[{
    RowBox[{"MetaboliteEMUs", "[", "bmap", "]"}], ",", 
    RowBox[{"EMU", "[", 
     RowBox[{
      RowBox[{"Metabolite", "[", 
       RowBox[{"_", ",", "\"\<Input\>\"", ",", "_"}], "]"}], ",", "__"}], 
     "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.941859023612929*^9, 3.941859025878706*^9}, {
  3.9418590585783453`*^9, 
  3.9418590798813133`*^9}},ExpressionUUID->"8acf436b-74c6-4ee1-85ea-\
fad4be2c5a50"],

Cell[BoxData[
 RowBox[{"substrateNames", "=", 
  RowBox[{"MetaboliteID", "/@", 
   RowBox[{"Metabolite", "/@", "substrates"}]}]}]], "Input",
 CellChangeTimes->{{3.9418591959084435`*^9, 
  3.941859205697996*^9}},ExpressionUUID->"59d71ad3-7983-4557-a6dc-\
5a51f3d24e43"],

Cell["\<\
We simulate all substrates except cysteine, which for some reason caused \
simulation errors\
\>", "Text",
 CellChangeTimes->{{3.9418581036399636`*^9, 3.9418581485000067`*^9}, {
  3.9418596870163183`*^9, 
  3.941859687498084*^9}},ExpressionUUID->"1f0bbbe0-24df-452f-8b93-\
81c22675cd9b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"substrateToSimulate", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{"substrates", ",", 
     RowBox[{"EMU", "[", 
      RowBox[{
       RowBox[{"Metabolite", "[", 
        RowBox[{
         RowBox[{"Except", "[", "\"\<cys-L\>\"", "]"}], ",", "\"\<Input\>\"", 
         ",", "_"}], "]"}], ",", "__"}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{"Length", "[", "substrateToSimulate", "]"}]}], "Input",
 CellChangeTimes->{{3.854011820739249*^9, 3.8540118325094333`*^9}, 
   3.8540125802484245`*^9, {3.8540126197881203`*^9, 3.854012690937939*^9}, {
   3.9418581827000475`*^9, 3.941858224929758*^9}, {3.941858978398527*^9, 
   3.941858998058299*^9}, {3.941859093318686*^9, 
   3.94185910692845*^9}},ExpressionUUID->"0d383652-ef1b-4fd7-ae2e-\
7c3491b5b828"],

Cell[BoxData[
 RowBox[{"simulationNames", "=", 
  RowBox[{"MetaboliteID", "/@", 
   RowBox[{"Metabolite", "/@", "substrateToSimulate"}]}]}]], "Input",
 CellChangeTimes->{{3.901107784280052*^9, 3.901107835152625*^9}, 
   3.901120388382677*^9, {3.941858373679312*^9, 3.9418583772490735`*^9}, {
   3.9418587273989873`*^9, 3.9418587284091544`*^9}, {3.9418591570577736`*^9, 
   3.9418591578580556`*^9}, 
   3.9418592100081244`*^9},ExpressionUUID->"c1e4747b-ca2d-4b78-8a7d-\
89a80c23ea34"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Specify substrate isotopomer distributions for each simulation\
\>", "Subsection",
 CellChangeTimes->{{3.8540719962564063`*^9, 3.8540720187809696`*^9}, {
  3.9011078483198504`*^9, 
  3.901107851569191*^9}},ExpressionUUID->"d9d9a521-1ee1-4ad0-a883-\
ded6de44cf75"],

Cell["\<\
Generate substrate isotopomer distributions with natural 13C distribution and \
tracer purity = 0.98\
\>", "Text",
 CellChangeTimes->{{3.8726739698573403`*^9, 3.8726739764843416`*^9}, {
  3.8726740086554055`*^9, 3.872674016492334*^9}, {3.903082736100337*^9, 
  3.903082739430421*^9}, {3.903083194341787*^9, 3.903083195145751*^9}, {
  3.9418583092094946`*^9, 
  3.941858323939265*^9}},ExpressionUUID->"a7891750-0815-4df8-9504-\
814250ec694f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"substrateDist", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"substrates", "/.", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"e", ":", 
          RowBox[{"EMU", "[", 
           RowBox[{"met", ",", "__"}], "]"}]}], "\[RuleDelayed]", 
         RowBox[{"Rule", "[", 
          RowBox[{"met", ",", 
           RowBox[{"TracerPurityIsotopomerDistribution", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Table", "[", 
               RowBox[{"1", ",", 
                RowBox[{"{", 
                 RowBox[{"EMUSize", "[", "e", "]"}], "}"}]}], "]"}], "}"}], 
             ",", 
             RowBox[{"{", "0.98", "}"}], ",", 
             RowBox[{"{", "0.0107", "}"}]}], "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"e", ":", 
          RowBox[{"EMU", "[", 
           RowBox[{"m_Metabolite", ",", "__"}], "]"}]}], "\[RuleDelayed]", 
         "\[IndentingNewLine]", 
         RowBox[{"Rule", "[", 
          RowBox[{"m", ",", 
           RowBox[{"NaturalIsotopomerDistribution", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"EMUSize", "[", "e", "]"}], "}"}], ",", 
             RowBox[{"{", "0.0107", "}"}]}], "]"}]}], "]"}]}]}], "}"}]}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"met", ",", 
       RowBox[{"Metabolite", "/@", "substrateToSimulate"}]}], "}"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{"Length", "[", "substrateDist", "]"}]}], "Input",
 CellChangeTimes->{{3.8540117705491133`*^9, 3.8540118177298875`*^9}, {
   3.8540123199083214`*^9, 3.8540123622888927`*^9}, {3.8540123954977255`*^9, 
   3.854012498105281*^9}, {3.8540126983163085`*^9, 3.8540127200481987`*^9}, {
   3.8540129087826176`*^9, 3.8540129264325976`*^9}, {3.8540129998174653`*^9, 
   3.854013010136995*^9}, {3.854080922882429*^9, 3.854080923912087*^9}, 
   3.85408096497662*^9, {3.854080998454793*^9, 3.854081046081579*^9}, {
   3.8726742572199917`*^9, 3.872674397166839*^9}, {3.87267444351645*^9, 
   3.8726744449902797`*^9}, {3.872674618863963*^9, 3.8726746226867323`*^9}, {
   3.9011063448026657`*^9, 3.901106407014268*^9}, {3.901106543372302*^9, 
   3.9011066216952763`*^9}, {3.9011066540985074`*^9, 3.901106659640997*^9}, {
   3.901107300197163*^9, 3.9011073986285753`*^9}, {3.903083210009592*^9, 
   3.903083287144902*^9}, {3.9030875180857096`*^9, 3.903087564602399*^9}, {
   3.941858344739731*^9, 3.94185836392937*^9}, 3.9418591419881916`*^9, 
   3.941859277817658*^9},ExpressionUUID->"a5e41789-b769-4f28-898a-\
709388a8ac9f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Substrate EMU MIDs", "Subsection",
 CellChangeTimes->{{3.8540720103260517`*^9, 3.854072027946142*^9}, 
   3.941859640317212*^9},ExpressionUUID->"ee0c7240-960e-4e82-8380-\
e0110d86151b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"allSubstrateEMUs", "=", 
   RowBox[{"Cases", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"SubstrateEMUs", "/@", "emuEq"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"EMU", "[", 
      RowBox[{
       RowBox[{"Metabolite", "[", 
        RowBox[{
         RowBox[{"Alternatives", "@@", "substrateNames"}], ",", "_", ",", 
         "_"}], "]"}], ",", "__"}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.854013471816668*^9, 3.854013483346883*^9}, {
  3.941858421129687*^9, 3.9418584250191813`*^9}, {3.9418586710894766`*^9, 
  3.9418587028187184`*^9}, {3.9418587383182955`*^9, 
  3.941858765538452*^9}},ExpressionUUID->"a7df903a-e10d-40cb-bb56-\
32c97a030b0f"],

Cell["\<\
Mass isotopomer distribution of an EMU for a metabolite with given isotopomer \
distribution.\
\>", "Text",
 CellChangeTimes->{{3.854073033134431*^9, 3.8540731364439673`*^9}, {
  3.854073188483843*^9, 3.8540733114741764`*^9}, {3.8540760170708666`*^9, 
  3.854076041119594*^9}, {3.941858519769122*^9, 
  3.941858520298727*^9}},ExpressionUUID->"3d456ce1-9a98-4858-99c7-\
88cc1eb80b19"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EMUMassIsotopomerDistribution", "[", 
   RowBox[{"e_EMU", ",", "isoDist_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "ml"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "arbitrarily", " ", "pick", " ", "first", " ", "member", " ", "of", " ", 
      RowBox[{"equiv", ".", " ", "class"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"First", "[", 
       RowBox[{"AtomNumbers", "[", "e", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "list", " ", "of", " ", "masses", " ", "of", " ", "the", " ", "EMU"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ml", "=", 
      RowBox[{"Tuples", "[", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", 
            RowBox[{"Length", "[", "#", "]"}]}], "]"}], "&"}], ",", "a"}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PDF", "[", 
        RowBox[{
         RowBox[{"MarginalizeToMID", "[", 
          RowBox[{"FragmentIsotopomerDistribution", "[", 
           RowBox[{"isoDist", ",", "a"}], "]"}], "]"}], ",", "x"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"x", ",", "ml"}], "}"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.854071807433839*^9, 3.854071886376557*^9}, {
  3.854072126005473*^9, 3.8540721340855417`*^9}, {3.8540760611996126`*^9, 
  3.8540761959594736`*^9}, {3.8540762272096615`*^9, 3.8540762320092173`*^9}, {
  3.8540764463087363`*^9, 
  3.8540764495086613`*^9}},ExpressionUUID->"01382e02-d766-4fb5-8ccc-\
12a44ad0f846"],

Cell["List of rules for all network inputs", "Text",
 CellChangeTimes->{{3.941858535458516*^9, 
  3.9418585474392233`*^9}},ExpressionUUID->"085ab0c0-6d3b-4073-8269-\
f46306059027"],

Cell[BoxData[
 RowBox[{
  RowBox[{"irList", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Rule", "[", 
        RowBox[{"e", ",", 
         RowBox[{"EMUMassIsotopomerDistribution", "[", 
          RowBox[{"e", ",", 
           RowBox[{
            RowBox[{"Metabolite", "[", "e", "]"}], "/.", "dist"}]}], "]"}]}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"e", ",", "allSubstrateEMUs"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"dist", ",", "substrateDist"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.833517442786337*^9, {3.833518031104019*^9, 3.8335180402263374`*^9}, 
   3.8335182375093346`*^9, {3.8335184482304535`*^9, 3.833518487063007*^9}, 
   3.8540127291476874`*^9, {3.854013248996961*^9, 3.8540132670667725`*^9}, {
   3.8540138389165587`*^9, 3.854013847945697*^9}, {3.8540139859595537`*^9, 
   3.8540140093279867`*^9}, {3.8540720462857947`*^9, 
   3.8540721474663496`*^9}, {3.8540765077989426`*^9, 
   3.8540765090386257`*^9}, {3.8540810845531664`*^9, 3.854081102901903*^9}, 
   3.9418587933783593`*^9},ExpressionUUID->"7820f5e8-d24b-44e7-b124-\
e70a16697a16"],

Cell["Check that all substrate EMUs sum to 1", "Text",
 CellChangeTimes->{{3.8540132820567813`*^9, 3.854013296866605*^9}, {
  3.8540765599189415`*^9, 
  3.854076562678988*^9}},ExpressionUUID->"307efc3e-7a29-4465-b579-\
c99681a382e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Union", "@", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Chop", "[", 
     RowBox[{"1", "-", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Total", "/@", 
         RowBox[{"Last", "/@", "ir"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ir", ",", "irList"}], "}"}]}], "]"}]}], "]"}]}]}], 
  "\[Equal]", 
  RowBox[{"{", "0", "}"}]}]], "Input",
 CellChangeTimes->{{3.941858591109*^9, 3.9418586129392514`*^9}, {
  3.9418588030687695`*^9, 
  3.941858861188567*^9}},ExpressionUUID->"a7fdf6a2-2b1b-4d8f-8df3-\
28927f09ee6e"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simulate steady-state isotopomer data", "Section",
 CellChangeTimes->{{3.677584496475876*^9, 3.677584498101297*^9}, {
   3.677584962039883*^9, 3.677584963883707*^9}, {3.9007470305243034`*^9, 
   3.900747033170594*^9}, {3.941859980782079*^9, 3.9418599829329257`*^9}, 
   3.941861600498866*^9},ExpressionUUID->"34e55f2d-6d53-4f83-b34c-\
c3fb37746f9c"],

Cell[CellGroupData[{

Cell["Simulate EMUs", "Subsection",
 CellChangeTimes->{{3.678187681102857*^9, 
  3.678187683162057*^9}},ExpressionUUID->"c5824257-c971-46bf-8cb6-\
f3c315b2038b"],

Cell["For each labeled substrate", "Text",
 CellChangeTimes->{{3.854081126461244*^9, 3.8540811471218643`*^9}, {
  3.901106716158263*^9, 3.9011067303688917`*^9}, {3.9418593756472936`*^9, 
  3.9418593818883185`*^9}},ExpressionUUID->"00283386-4d2c-46f9-8f67-\
c8d2bc8ce316"],

Cell[BoxData[
 RowBox[{
  RowBox[{"emuSol", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"EMUSimulate", "[", 
      RowBox[{"emuEq", ",", "ir", ",", 
       RowBox[{
        RowBox[{"EMUFluxMap", "[", "net", "]"}], "[", "trueFlux", "]"}]}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"ir", ",", "irList"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.677584517212943*^9, 3.6775845198035765`*^9}, {
   3.677584661631009*^9, 3.6775846694215097`*^9}, {3.6775847498787484`*^9, 
   3.6775847596378746`*^9}, 3.8540133397866845`*^9, {3.8540811522319717`*^9, 
   3.854081163071703*^9}, 
   3.9011074838151903`*^9},ExpressionUUID->"5cd4227d-46d5-4080-a020-\
3285800e4fb0"],

Cell[BoxData[
 RowBox[{"Length", "[", "emuSol", "]"}]], "Input",
 CellChangeTimes->{{3.901106850805435*^9, 
  3.901106854047554*^9}},ExpressionUUID->"ffbb62ac-b134-42ed-8d5b-\
1402e8c8643f"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Nonstationary simulation", "Section",
 CellChangeTimes->{{3.833427095276762*^9, 
  3.833427097520773*^9}},ExpressionUUID->"bb0f1596-2bb7-42dc-8b6e-\
10c08769bace"],

Cell["\<\
Here, all MI fractions are time-dependent variables. Each internal EMU is \
associated with a differential equation over time. The condensations are the \
same, but also time dependent.\
\>", "Text",
 CellChangeTimes->{{3.833427103252946*^9, 3.8334272082014894`*^9}, 
   3.833434128588346*^9, {3.941859992453212*^9, 
   3.9418600136640253`*^9}},ExpressionUUID->"6b548ce2-3d8a-4a52-b650-\
18944b63897e"],

Cell["In tensor form, the EMU differential equation system is", "Text",
 CellChangeTimes->{{3.833427356723112*^9, 3.8334273710140476`*^9}, {
  3.833427401016466*^9, 3.8334274033074317`*^9}, {3.833427456111278*^9, 
  3.8334276040695686`*^9}, {3.833427761868391*^9, 3.8334278007614803`*^9}, {
  3.8334299283047113`*^9, 3.83342992872147*^9}, {3.833429967750696*^9, 
  3.833430009826214*^9}, {3.941860048665276*^9, 
  3.9418600701864614`*^9}},ExpressionUUID->"fb974e80-e0ae-47b1-95d3-\
5758bc620ce0"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"T", " ", 
    RowBox[{"dX", "/", "dt"}]}], " ", "=", " ", 
   RowBox[{
    RowBox[{"A", " ", "v", " ", 
     RowBox[{"X", "(", "t", ")"}]}], "+", 
    RowBox[{"B", " ", "b", " ", "Y"}], "+", 
    RowBox[{"C", " ", "v", " ", 
     RowBox[{"Z", "(", "t", ")"}]}], "-", 
    RowBox[{"D", " ", "v", " ", 
     RowBox[{"X", "(", "t", ")"}]}]}]}], TraditionalForm]],
 FormatType->
  "TraditionalForm",ExpressionUUID->"9eae6d62-8e91-4905-8f6f-5a58c3249a98"]], \
"Text",
 CellChangeTimes->{{3.9418600733869514`*^9, 
  3.9418601296487226`*^9}},ExpressionUUID->"7b139b41-533e-43e5-af5b-\
93ff6af66754"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox["T", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "53a0e466-d14d-42e3-a10f-d07665362d18"],
 " is a diagnonal matrix of concentrations for each metabolite (same for all \
EMUs from that metabolite), and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"X", ",", "Y", ",", "Z"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "dd6c1b67-d2fa-4a6f-bb34-ef4e8f4bef96"],
 " are the internal, substrate and condensation tensors, respectively."
}], "Text",
 CellChangeTimes->{{3.833427356723112*^9, 3.8334273710140476`*^9}, {
  3.833427401016466*^9, 3.8334274033074317`*^9}, {3.833427456111278*^9, 
  3.8334276040695686`*^9}, {3.833427761868391*^9, 3.8334278007614803`*^9}, {
  3.8334299283047113`*^9, 3.83342992872147*^9}, {3.833429967750696*^9, 
  3.833430009826214*^9}, {3.941860048665276*^9, 3.941860067166772*^9}, {
  3.941860133498884*^9, 
  3.9418601819957204`*^9}},ExpressionUUID->"376508f4-f273-4e2d-8fec-\
0fe98132963f"],

Cell[CellGroupData[{

Cell["Parameters", "Subsection",
 CellChangeTimes->{{3.8334317380034375`*^9, 3.833431740958871*^9}, 
   3.8335190082740207`*^9, {3.901108809017185*^9, 
   3.9011088105109196`*^9}},ExpressionUUID->"0a82fada-cce4-4281-a157-\
444c477690e5"],

Cell["Metabolite concentrations", "Text",
 CellChangeTimes->{{3.8334287808450356`*^9, 3.833428790942728*^9}, {
  3.9418601864909353`*^9, 
  3.941860207140566*^9}},ExpressionUUID->"3d647635-8a1d-4a26-ab0b-\
54bc344f34a5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"metaboliteConc", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{
     RowBox[{"Metabolites", "[", "net", "]"}], "\[Rule]", "1.0"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8334287688425484`*^9, 3.8334288637818613`*^9}, {
   3.8335100968713427`*^9, 3.833510164910917*^9}, {3.8335150508555045`*^9, 
   3.8335150590651064`*^9}, 3.833515274177042*^9, {3.8335153240981007`*^9, 
   3.833515330585664*^9}, {3.833518958556265*^9, 3.833518989588312*^9}, {
   3.8733409356099124`*^9, 
   3.8733409429482*^9}},ExpressionUUID->"d73bf8a9-e225-4d6f-a3dc-\
8fa4064a883d"],

Cell["We have one state variable for each EMU concentration", "Text",
 CellChangeTimes->{{3.9418602576905127`*^9, 
  3.941860269509968*^9}},ExpressionUUID->"676900c1-2cd6-4456-9d2e-\
06fb0e59503a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"x", "[", 
      RowBox[{"e", ",", "j"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"eq", ",", "emuEq"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"e", ",", 
       RowBox[{"InternalEMUs", "[", "eq", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "0", ",", 
       RowBox[{"EMUSize", "[", 
        RowBox[{"First", "[", 
         RowBox[{"InternalEMUs", "[", "eq", "]"}], "]"}], "]"}]}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", 
  RowBox[{"Flatten", "[", "variables", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8334318161026897`*^9, 3.833431939313368*^9}, {
   3.8334320308505507`*^9, 3.833432052202305*^9}, {3.8334324775822134`*^9, 
   3.8334324789484596`*^9}, {3.8334325380549583`*^9, 3.833432542245015*^9}, {
   3.8334329259221983`*^9, 3.8334329300027275`*^9}, 3.9011087413262796`*^9, {
   3.9418602189609556`*^9, 
   3.9418602385100408`*^9}},ExpressionUUID->"71f750ca-300e-4381-a007-\
4d61fd61079e"],

Cell[TextData[{
 "We set the initial state to be unlabeled, so that ",
 StyleBox["x[e, j]", "Input"],
 " is the unit vector"
}], "Text",
 CellChangeTimes->{{3.833431760639453*^9, 3.833431810463605*^9}, {
  3.9418602858107023`*^9, 
  3.9418603077500763`*^9}},ExpressionUUID->"a116b6fa-b399-4405-b744-\
6dd3bc92b98b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"initial", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"e", ",", "j"}], "]"}], "[", "0", "]"}], "\[Equal]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"j", "\[Equal]", "0"}], ",", "1", ",", "0"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"eq", ",", "emuEq"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"e", ",", 
       RowBox[{"InternalEMUs", "[", "eq", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "0", ",", 
       RowBox[{"EMUSize", "[", 
        RowBox[{"First", "[", 
         RowBox[{"InternalEMUs", "[", "eq", "]"}], "]"}], "]"}]}], "}"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8334318161026897`*^9, 
  3.833431939313368*^9}},ExpressionUUID->"0678590c-74f7-4fd1-958e-\
11db98b33fa6"],

Cell["Simulation end time", "Text",
 CellChangeTimes->{{3.9418603475004883`*^9, 
  3.941860349580119*^9}},ExpressionUUID->"f3fb4437-8841-474e-bd3d-\
78c45ecb8725"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tFinal", "=", "2000.0"}], ";"}]], "Input",
 CellChangeTimes->{{3.833433360855962*^9, 3.833433364704767*^9}, 
   3.833515123025383*^9, 3.833520469945668*^9, {3.8733410489669943`*^9, 
   3.8733410490311546`*^9}, {3.8733410989260483`*^9, 3.873341099026517*^9}, {
   3.873343458785326*^9, 3.873343458885316*^9}, {3.8733440688853426`*^9, 
   3.8733440689694595`*^9}, {3.8733441221271753`*^9, 3.87334412219616*^9}, 
   3.90074641807435*^9, {3.9007468131781635`*^9, 3.9007468136017447`*^9}, 
   3.900748111130739*^9, {3.900748302491374*^9, 
   3.9007483028142643`*^9}},ExpressionUUID->"673ff5a9-8da4-4fd3-beb7-\
5ab335e6266c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Generate equation systems", "Subsection",
 CellChangeTimes->{{3.8334317528784637`*^9, 3.8334317543202496`*^9}, 
   3.9011090025418844`*^9, {3.9011090394447656`*^9, 
   3.901109047811113*^9}},ExpressionUUID->"3d9ef832-789f-4b66-9e77-\
1f31cfa99f89"],

Cell["\<\
Substrate distributions are hardcoded into the differential equations\
\>", "Text",
 CellChangeTimes->{{3.901108831442817*^9, 
  3.9011088518908405`*^9}},ExpressionUUID->"6177001d-744b-4c06-ace4-\
affb4d4d392b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"emuDiffEqn", "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v", ",", "c"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"v", "=", 
       RowBox[{
        RowBox[{"EMUFluxMap", "[", "net", "]"}], "[", "trueFlux", "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{"Metabolite", ",", 
          RowBox[{"InternalEMUs", "/@", "emuEq"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}], "/.", "metaboliteConc"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"EMUDiffEquation", "[", 
         RowBox[{"emuEq", ",", "x", ",", "t", ",", 
          RowBox[{
          "irList", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          ",", "v", ",", "c"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "simulationNames", "]"}]}], "}"}]}], 
       "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8334286663660746`*^9, 3.83342866871049*^9}, {
   3.8334287089082575`*^9, 3.8334287107447195`*^9}, {3.833428871302995*^9, 
   3.833428871958075*^9}, {3.833430935710859*^9, 3.8334309416434183`*^9}, 
   3.8334315533999305`*^9, 3.833431592550657*^9, {3.833508901291856*^9, 
   3.8335089019076834`*^9}, {3.8335194458936796`*^9, 3.8335194461336126`*^9}, 
   3.8335195172107954`*^9, {3.8733409494447775`*^9, 3.8733409519721947`*^9}, {
   3.8733429247760844`*^9, 3.873342926598359*^9}, 3.9007461938990216`*^9, {
   3.9011089149597125`*^9, 3.901108985581109*^9}, {3.901109121212988*^9, 
   3.9011091388939734`*^9}, {3.9011091715861597`*^9, 
   3.9011091717557554`*^9}, {3.901116455878708*^9, 
   3.9011165405809884`*^9}},ExpressionUUID->"0e84f7d1-90c6-494f-b826-\
928c36f7862c"],

Cell[BoxData[
 RowBox[{"Dimensions", "/@", 
  RowBox[{
  "emuDiffEqn", "\[LeftDoubleBracket]", "8", 
   "\[RightDoubleBracket]"}]}]], "Input",
 CellChangeTimes->{{3.901120591023445*^9, 
  3.901120601465242*^9}},ExpressionUUID->"a138e73f-81b4-4d69-804d-\
6d59ffd85b9c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Simulate systems", "Subsection",
 CellChangeTimes->{{3.8334317528784637`*^9, 3.8334317543202496`*^9}, 
   3.9011090025418844`*^9},ExpressionUUID->"2e5f8c3c-efca-4bbd-890d-\
299fde2bd61c"],

Cell["Constrain NDSolve memory usage", "Text",
 CellChangeTimes->{{3.941860558551345*^9, 3.9418606104694014`*^9}, {
  3.9418608262241797`*^9, 
  3.9418608569913077`*^9}},ExpressionUUID->"75204b8d-e451-4644-af5f-\
b3d1fc3478c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"maxMemoryToUse", "=", 
   RowBox[{"6", "*", 
    RowBox[{"10", "^", "9"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9418603911771903`*^9, 
  3.941860405789866*^9}},ExpressionUUID->"c3eaaed1-f68a-4641-ab26-\
80292ba76e26"],

Cell[BoxData[
 RowBox[{
  RowBox[{"solutions", "=", 
   RowBox[{"MemoryConstrained", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "simulationNames", "\[LeftDoubleBracket]", "k", 
          "\[RightDoubleBracket]"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"variables", "/.", 
         RowBox[{"First", "[", "\[IndentingNewLine]", 
          RowBox[{"NDSolve", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{
               "emuDiffEqn", "\[LeftDoubleBracket]", "k", 
                "\[RightDoubleBracket]"}], "]"}], ",", 
              RowBox[{"Flatten", "[", "initial", "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Flatten", "[", "variables", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", "tFinal"}], "}"}]}], "]"}], 
          "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"Length", "[", "simulationNames", "]"}]}], "}"}]}], "]"}], 
     ",", "\[IndentingNewLine]", "maxMemoryToUse"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8334319979540987`*^9, 3.833432019379134*^9}, {
   3.833432077530196*^9, 3.833432097403271*^9}, {3.83343218905682*^9, 
   3.8334321920655546`*^9}, {3.833432367138111*^9, 3.8334324010301514`*^9}, {
   3.8334324843485622`*^9, 3.8334324870563335`*^9}, {3.8334325481309295`*^9, 
   3.8334325492028522`*^9}, {3.833432958700916*^9, 3.833432961609315*^9}, 
   3.83343299537693*^9, {3.833433036326872*^9, 3.8334330644073424`*^9}, {
   3.8334333691017737`*^9, 3.833433369803777*^9}, {3.8335197337611094`*^9, 
   3.8335197358468623`*^9}, {3.9011090722883787`*^9, 3.901109089070505*^9}, {
   3.9011091850235376`*^9, 3.9011091878486195`*^9}, {3.9011099606208954`*^9, 
   3.9011099608548927`*^9}, 3.9011167503854313`*^9, {3.9011173062363663`*^9, 
   3.9011173084261627`*^9}, {3.9011175676427584`*^9, 
   3.9011175714948015`*^9}, {3.9011179282658515`*^9, 3.901117937463396*^9}, {
   3.9011185325135965`*^9, 3.901118590104686*^9}, {3.901118941980688*^9, 
   3.9011189626680202`*^9}, 3.901119267309644*^9, {3.9011206488070507`*^9, 
   3.901120650165574*^9}, {3.9011208690929146`*^9, 3.9011208691936417`*^9}, 
   3.9011210004324427`*^9, {3.9011218069634476`*^9, 3.901121838646655*^9}, {
   3.9011223641792154`*^9, 3.9011223649075584`*^9}, {3.901122605839502*^9, 
   3.901122608457348*^9}, {3.901156871426261*^9, 3.9011568943243556`*^9}, 
   3.901156942003461*^9, {3.9011570134606524`*^9, 3.901157020661569*^9}, 
   3.901157085467823*^9, {3.901157199595112*^9, 3.901157199632323*^9}, 
   3.9011573146734533`*^9, {3.901157415033187*^9, 3.9011574314807925`*^9}, {
   3.901166384488326*^9, 3.901166420375763*^9}, {3.9011669487196836`*^9, 
   3.9011670065369697`*^9}, {3.9011670460541267`*^9, 3.9011670526071157`*^9}, 
   3.9011671338465214`*^9, {3.901167177533454*^9, 3.9011672227458577`*^9}, {
   3.901167516198419*^9, 3.9011675162835617`*^9}, 3.9011686180570164`*^9, {
   3.903086370071187*^9, 3.903086377491083*^9}, {3.941860401650406*^9, 
   3.9418604692201347`*^9}},ExpressionUUID->"f7578180-10a7-4296-8ea5-\
77b324542fb1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plot solutions (ED Figure 3a)", "Subsection",
 CellChangeTimes->{{3.87334236959182*^9, 3.873342371966056*^9}, {
  3.9418615146987953`*^9, 
  3.9418615366190724`*^9}},ExpressionUUID->"c8d71cb4-1ed2-405d-bc59-\
61fbe154dbba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"functionIndex", "=", 
   RowBox[{"Join", "@@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"variables", ",", 
        RowBox[{"x", "[", 
         RowBox[{"e", ",", 
          RowBox[{"EMUSize", "[", "e", "]"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"e", ",", "targets"}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9011172535315914`*^9, 3.9011172620257664`*^9}, {
  3.9011178218391256`*^9, 
  3.9011178417103443`*^9}},ExpressionUUID->"fec4f722-ab23-46ca-b936-\
5030c1319026"],

Cell["Glucose simulation (ED Figure 3a)", "Text",
 CellChangeTimes->{{3.9418606464227953`*^9, 3.9418606505794773`*^9}, {
  3.941861507709072*^9, 
  3.941861534699108*^9}},ExpressionUUID->"2ed58c96-0af3-4c0c-a763-\
addd6287e9d6"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"k", "=", "8"}], ",", 
     RowBox[{"ix", "=", "functionIndex"}], ",", "fl", ",", "vl"}], "}"}], ",",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fl", "=", 
     RowBox[{"Extract", "[", 
      RowBox[{
       RowBox[{
       "solutions", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}], 
       ",", "ix"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"vl", "=", 
     RowBox[{"Extract", "[", 
      RowBox[{"variables", ",", "ix"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"f", "[", "t", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", "fl"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "200", ",", "1"}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], ",", 
      RowBox[{"Joined", "\[Rule]", "True"}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Blue", ",", 
         RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
      RowBox[{"PlotLabel", "\[Rule]", 
       RowBox[{
       "simulationNames", "\[LeftDoubleBracket]", "8", 
        "\[RightDoubleBracket]"}]}]}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.833432128294118*^9, 3.8334321733431425`*^9}, {
   3.8334322053195596`*^9, 3.833432208559691*^9}, {3.833432248264168*^9, 
   3.833432268943052*^9}, 3.833432343153552*^9, {3.8334323755637684`*^9, 
   3.833432385370578*^9}, {3.833433059825731*^9, 3.8334330952473106`*^9}, 
   3.8334333758988028`*^9, 3.8334334943352823`*^9, {3.833509182477705*^9, 
   3.8335091831173186`*^9}, {3.833509300349764*^9, 3.8335093548149347`*^9}, {
   3.833515229434928*^9, 3.8335152561680818`*^9}, {3.8335153501766615`*^9, 
   3.8335153590558863`*^9}, {3.8335155315218916`*^9, 
   3.8335155413915005`*^9}, {3.873341179625594*^9, 3.8733411889927783`*^9}, {
   3.8733412970430884`*^9, 3.8733412972589703`*^9}, {3.873341467782365*^9, 
   3.873341522502192*^9}, {3.8733415689051685`*^9, 3.8733416091422324`*^9}, {
   3.873341703138547*^9, 3.8733417032072163`*^9}, {3.8733418176707687`*^9, 
   3.8733418839027977`*^9}, {3.873341922087734*^9, 3.8733419241772203`*^9}, {
   3.8733419550249386`*^9, 3.8733419703881536`*^9}, {3.873342087557629*^9, 
   3.873342147924219*^9}, {3.9006401074879045`*^9, 3.9006401132601824`*^9}, {
   3.9007465402858143`*^9, 3.9007465453272476`*^9}, {3.901116863683967*^9, 
   3.9011168663288174`*^9}, 3.9011168968719983`*^9, {3.9011171038556595`*^9, 
   3.9011172685576253`*^9}, {3.901117631608537*^9, 3.9011176510967417`*^9}, {
   3.9011177060161877`*^9, 3.9011177771844435`*^9}, {3.90111786216218*^9, 
   3.9011178923294573`*^9}, {3.9011189785956836`*^9, 3.901118979337271*^9}, {
   3.9011686607528725`*^9, 3.901168663832823*^9}, {3.9011688109149294`*^9, 
   3.901168815068802*^9}, {3.903088020309026*^9, 3.903088026321951*^9}, {
   3.9418614360290656`*^9, 
   3.94186148855875*^9}},ExpressionUUID->"6d2d9943-5899-47b4-a894-\
5ed0f16b3555"]
}, Closed]],

Cell[CellGroupData[{

Cell["Check final time point against steady state solution", "Subsection",
 CellChangeTimes->{{3.873342051571731*^9, 3.873342052491432*^9}, {
  3.873342415140284*^9, 3.873342421547947*^9}, {3.9007483892357283`*^9, 
  3.9007483898550224`*^9}, {3.9418606638294086`*^9, 3.941860666323595*^9}, {
  3.9418623603779645`*^9, 
  3.941862362977954*^9}},ExpressionUUID->"d25168b2-74ee-44e5-8219-\
559d9f1274c2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"emuIndex", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Position", "[", 
      RowBox[{"variables", ",", 
       RowBox[{"x", "[", 
        RowBox[{"e", ",", "_"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"e", ",", "targets"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{"Length", "[", "emuIndex", "]"}]}], "Input",
 CellChangeTimes->{3.9011180392985163`*^9, 
  3.9418616337481527`*^9},ExpressionUUID->"a407dea2-9537-4cd0-8514-\
1472f1a2f416"],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"k", "=", "8"}], ",", 
      RowBox[{"t", "=", "2000"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"statMIDs", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "emuSol", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}], 
         "[", "e", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"e", ",", "targets"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nonStatMIDs", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"f", "[", "t", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ix", ",", "emuIndex"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", 
          RowBox[{"Extract", "[", 
           RowBox[{
            RowBox[{
            "solutions", "\[LeftDoubleBracket]", "k", 
             "\[RightDoubleBracket]"}], ",", "ix"}], "]"}]}], "}"}]}], 
       "]"}]}]}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.833432128294118*^9, 3.8334321733431425`*^9}, {
   3.8334322053195596`*^9, 3.833432208559691*^9}, {3.833432248264168*^9, 
   3.833432268943052*^9}, 3.833432343153552*^9, {3.8334323755637684`*^9, 
   3.833432385370578*^9}, {3.833433059825731*^9, 3.8334330952473106`*^9}, 
   3.8334333758988028`*^9, 3.8334334943352823`*^9, {3.833509182477705*^9, 
   3.8335091831173186`*^9}, {3.833509300349764*^9, 3.8335093548149347`*^9}, {
   3.833515229434928*^9, 3.8335152561680818`*^9}, {3.8335153501766615`*^9, 
   3.8335153590558863`*^9}, {3.8335155315218916`*^9, 
   3.8335155413915005`*^9}, {3.873341179625594*^9, 3.8733411889927783`*^9}, {
   3.8733412970430884`*^9, 3.8733412972589703`*^9}, {3.873341467782365*^9, 
   3.873341522502192*^9}, {3.8733415689051685`*^9, 3.8733416091422324`*^9}, {
   3.873341703138547*^9, 3.8733417032072163`*^9}, {3.8733418176707687`*^9, 
   3.8733418839027977`*^9}, {3.873341922087734*^9, 3.8733419241772203`*^9}, {
   3.8733419550249386`*^9, 3.8733419703881536`*^9}, {3.8733420073667045`*^9, 
   3.8733420337238703`*^9}, {3.873342427374627*^9, 3.873342556758498*^9}, {
   3.900640136351026*^9, 3.9006401370624704`*^9}, {3.900640520911908*^9, 
   3.900640619319349*^9}, {3.900640650627963*^9, 3.90064069858707*^9}, {
   3.9006407327136636`*^9, 3.9006407884438376`*^9}, {3.9007472573530025`*^9, 
   3.900747513433188*^9}, {3.9007475484244375`*^9, 3.9007475527452455`*^9}, {
   3.9007476099825516`*^9, 3.9007476179968452`*^9}, {3.900747699315648*^9, 
   3.9007477359242244`*^9}, {3.9007478971115046`*^9, 
   3.9007479740670476`*^9}, {3.900748262648076*^9, 3.900748269406393*^9}, {
   3.900748422130253*^9, 3.9007484307415476`*^9}, {3.900748988329263*^9, 
   3.9007489963415475`*^9}, {3.90111801664697*^9, 3.9011180294554033`*^9}, {
   3.90111808024093*^9, 3.9011181399804*^9}, 3.9011182301933565`*^9, {
   3.90111827264237*^9, 3.9011183815797424`*^9}, {3.9011184155147586`*^9, 
   3.901118423032297*^9}, {3.9011193203017783`*^9, 3.9011193379906015`*^9}, {
   3.901122761988924*^9, 3.9011227620578685`*^9}, {3.901168736747514*^9, 
   3.9011687896434526`*^9}, {3.9011688304185524`*^9, 3.901168831356193*^9}, {
   3.901168874468777*^9, 3.90116888667027*^9}, {3.901168931575967*^9, 
   3.9011689407872353`*^9}, {3.903088107223197*^9, 3.903088107324334*^9}, {
   3.941861649298728*^9, 
   3.941861663648884*^9}},ExpressionUUID->"66378574-a343-437e-8e0e-\
f5256424b894"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"Flatten", "/@", 
     RowBox[{"{", 
      RowBox[{"statMIDs", ",", "nonStatMIDs"}], "}"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.833432128294118*^9, 3.8334321733431425`*^9}, {
   3.8334322053195596`*^9, 3.833432208559691*^9}, {3.833432248264168*^9, 
   3.833432268943052*^9}, 3.833432343153552*^9, {3.8334323755637684`*^9, 
   3.833432385370578*^9}, {3.833433059825731*^9, 3.8334330952473106`*^9}, 
   3.8334333758988028`*^9, 3.8334334943352823`*^9, {3.833509182477705*^9, 
   3.8335091831173186`*^9}, {3.833509300349764*^9, 3.8335093548149347`*^9}, {
   3.833515229434928*^9, 3.8335152561680818`*^9}, {3.8335153501766615`*^9, 
   3.8335153590558863`*^9}, {3.8335155315218916`*^9, 
   3.8335155413915005`*^9}, {3.873341179625594*^9, 3.8733411889927783`*^9}, {
   3.8733412970430884`*^9, 3.8733412972589703`*^9}, {3.873341467782365*^9, 
   3.873341522502192*^9}, {3.8733415689051685`*^9, 3.8733416091422324`*^9}, {
   3.873341703138547*^9, 3.8733417032072163`*^9}, {3.8733418176707687`*^9, 
   3.8733418839027977`*^9}, {3.873341922087734*^9, 3.8733419241772203`*^9}, {
   3.8733419550249386`*^9, 3.8733419703881536`*^9}, {3.8733420073667045`*^9, 
   3.8733420337238703`*^9}, {3.873342427374627*^9, 3.873342556758498*^9}, {
   3.900640136351026*^9, 3.9006401370624704`*^9}, {3.900640520911908*^9, 
   3.900640619319349*^9}, {3.900640650627963*^9, 3.90064069858707*^9}, {
   3.9006407327136636`*^9, 3.9006407884438376`*^9}, {3.9007472573530025`*^9, 
   3.900747513433188*^9}, {3.9007475484244375`*^9, 3.9007475527452455`*^9}, {
   3.9007476099825516`*^9, 3.9007476163495083`*^9}, {3.900747750419932*^9, 
   3.900747755151953*^9}, {3.9007484439304347`*^9, 3.900748450686679*^9}, {
   3.900748909752684*^9, 3.9007489349782495`*^9}, {3.9007490177851877`*^9, 
   3.9007490220246716`*^9}, {3.900750463260603*^9, 3.9007504642108283`*^9}, {
   3.9011182376414747`*^9, 
   3.9011182499552794`*^9}},ExpressionUUID->"7a0441f6-c29e-4036-b386-\
9ca59188ef0c"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export simulated MIDs", "Section",
 CellChangeTimes->{{3.9011222616865177`*^9, 3.901122268457082*^9}, {
  3.9418616929385033`*^9, 
  3.9418616986986623`*^9}},ExpressionUUID->"ca830aa5-a702-479a-9176-\
27ca8d8bfb66"],

Cell["\<\
This yields a simulations x MI array with all MIDs concatenated\
\>", "Text",
 CellChangeTimes->{{3.9011195993492594`*^9, 3.901119627492051*^9}, {
  3.901169152520175*^9, 3.9011691533776383`*^9}, {3.9418618543184524`*^9, 
  3.9418618589683385`*^9}, {3.9418619717877607`*^9, 
  3.941862000768598*^9}},ExpressionUUID->"b7c26c83-9055-482a-a484-\
1731a51f92c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"simulatedMids", "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"functions", ",", 
       RowBox[{"timePoint", "=", "75"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"functions", "=", 
         RowBox[{"Extract", "[", 
          RowBox[{
           RowBox[{
           "solutions", "\[LeftDoubleBracket]", "k", 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{"Join", "@@", "emuIndex"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"f", "[", "timePoint", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"f", ",", "functions"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"Length", "[", "simulationNames", "]"}]}], "}"}]}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9011192251087365`*^9, 3.9011192593082743`*^9}, {
  3.901119632459075*^9, 3.90111971376381*^9}, {3.901168984340207*^9, 
  3.901169000188265*^9}, {3.9011690726995115`*^9, 3.901169157670757*^9}, {
  3.9418617509386225`*^9, 
  3.9418618375887823`*^9}},ExpressionUUID->"cee4efc0-21d0-4079-9f2d-\
f69f31093925"],

Cell[BoxData[
 RowBox[{"Dimensions", "[", "simulatedMids", "]"}]], "Input",
 CellChangeTimes->{{3.9418618449782333`*^9, 
  3.941861849369574*^9}},ExpressionUUID->"7af0110b-6e9e-44d6-af74-\
f07b463b4f3b"],

Cell["Add metabolite names and MI numbers", "Text",
 CellChangeTimes->{{3.9418621594278116`*^9, 
  3.9418621707779446`*^9}},ExpressionUUID->"670bd425-a2f0-44ec-a542-\
7f4af12afec0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"simulatedMidTable", "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mi", ",", "met"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"met", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"MetaboliteShortName", "[", 
           RowBox[{"Metabolite", "[", "e", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"e", ",", "targets"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", 
            RowBox[{"EMUSize", "[", "e", "]"}]}], "}"}]}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"mi", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", 
            RowBox[{"EMUSize", "[", "e", "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"e", ",", "targets"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ArrayFlatten", "[", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"\"\<Metabolite\>\"", ",", "\"\<MI\>\""}], "}"}], "}"}], 
           ",", 
           RowBox[{"{", "simulationNames", "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"met", ",", "mi"}], "}"}], "]"}], ",", 
           RowBox[{"Transpose", "[", "simulatedMids", "]"}]}], "}"}]}], "}"}],
        "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.941862100977756*^9, 3.9418621523578568`*^9}, {
  3.9418621877174025`*^9, 
  3.9418621915883007`*^9}},ExpressionUUID->"73b2b41b-fc2e-4403-9085-\
b1cba46f9abb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Take", "[", 
   RowBox[{"simulatedMidTable", ",", "10", ",", "10"}], "]"}], "//", 
  "TableForm"}]], "Input",
 CellChangeTimes->{{3.9418622004874315`*^9, 
  3.9418622098281007`*^9}},ExpressionUUID->"88878906-0475-434f-8f93-\
7859157b27a1"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<simulated_mids_t75.tsv\>\"", ",", "simulatedMidTable"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9007259382841864`*^9, 3.9007261636297417`*^9}, {
  3.9007262199721203`*^9, 3.9007264010936017`*^9}, {3.900726501444485*^9, 
  3.9007265123917246`*^9}, {3.901119908288779*^9, 3.901119962315984*^9}, {
  3.901169221837081*^9, 3.9011692634095736`*^9}, {3.9011693362153435`*^9, 
  3.9011693372368774`*^9}, {3.94186206671745*^9, 3.9418620948483224`*^9}, {
  3.9418622233476715`*^9, 
  3.941862229187859*^9}},ExpressionUUID->"4d3b1c2e-c760-4c89-a3cd-\
6cbb00dda818"]
}, Closed]],

Cell[CellGroupData[{

Cell["Compute fraction-derived matrix (\[OpenCurlyDoubleQuote]gold standard\
\[CloseCurlyDoubleQuote])", "Section",
 CellChangeTimes->{{3.9418633653365*^9, 
  3.9418633796960917`*^9}},ExpressionUUID->"384aab85-fe18-49a0-bc7a-\
3e434f099d82"],

Cell[CellGroupData[{

Cell["Mutating metabolic networks", "Subsection",
 CellChangeTimes->{{3.87508424337172*^9, 3.8750842464029527`*^9}, {
  3.9418637752542887`*^9, 
  3.9418637789043307`*^9}},ExpressionUUID->"06d7e0e4-7ce9-487d-8391-\
302a6250917e"],

Cell[TextData[{
 "This \[OpenCurlyDoubleQuote]mutates\[CloseCurlyDoubleQuote] a metabolic \
network so that the metabolite ",
 StyleBox["met", "Input"],
 " becomes a substrate. We remove all EMU reactions entering ",
 StyleBox["met", "Input"],
 ", and instead transfer the corresponding flux to an input reactions \
producing ",
 StyleBox["met", "Input"],
 ". This ensures that the flux vector is unchanged. "
}], "Text",
 CellChangeTimes->{{3.875003520302226*^9, 3.8750035250038157`*^9}, {
  3.941863434896613*^9, 3.9418636158358636`*^9}, {3.941863666078755*^9, 
  3.9418637491336956`*^9}, {3.941863781393799*^9, 
  3.9418637829940586`*^9}},ExpressionUUID->"ca253f2c-87b1-413c-a388-\
31d04741d0bb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MutateNetwork", "[", 
   RowBox[{"net_MetabolicNetwork", ",", "met_Metabolite", ",", 
    RowBox[{"er", ":", 
     RowBox[{"{", 
      RowBox[{"_EMUReaction", ".."}], "}"}]}], ",", 
    RowBox[{"flux_", "?", "VectorQ"}], ",", 
    RowBox[{"substrates", ":", 
     RowBox[{"{", 
      RowBox[{"_EMU", ".."}], "}"}]}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "metIn", ",", "jIn", ",", "metNew", ",", "erNew", ",", "fluxNew", ",", 
      "metEMUs", ",", "jIndex", ",", "dist"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"metIn", "=", 
      RowBox[{"Metabolite", "[", 
       RowBox[{
        RowBox[{"MetaboliteID", "[", "met", "]"}], ",", "\"\<Input\>\"", ",", 
        "\"\<Boundary\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "add", " ", "input", " ", "reaction", " ", "if", " ", "necessary"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"erNew", "=", "er"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<Uptake\>\"", ",", "\"\<Free\>\""}], "}"}], ",", 
         RowBox[{"ExchangeStatus", "[", "met", "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"input", " ", "reaction", " ", "already", " ", "exists"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"jIn", "=", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"InputMetabolites", "[", "net", "]"}], ",", 
            RowBox[{"Metabolite", "[", 
             RowBox[{
              RowBox[{"MetaboliteID", "[", "met", "]"}], ",", "__"}], "]"}]}],
            "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"fluxNew", "=", "flux"}], ";", "\[IndentingNewLine]", 
        RowBox[{"metNew", "=", "met"}], ";", "\[IndentingNewLine]", 
        RowBox[{"metEMUs", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"Cases", "[", 
           RowBox[{"erNew", ",", 
            RowBox[{
             RowBox[{"EMUReaction", "[", 
              RowBox[{"_", ",", "_", ",", 
               RowBox[{"e", ":", 
                RowBox[{"EMU", "[", 
                 RowBox[{"metNew", ",", "_"}], "]"}]}], ",", "_"}], "]"}], 
             "\[Rule]", "e"}]}], "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "else", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "add", " ", "new", " ", "input", " ", "reaction", " ", "as", " ", 
         "first", " ", "reaction"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"jIn", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"fluxNew", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "0", "}"}], ",", "flux"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "renumber", " ", "EMU", " ", "reactions", " ", "accordingly"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"erNew", "=", 
         RowBox[{"Replace", "[", 
          RowBox[{"erNew", ",", 
           RowBox[{
            RowBox[{"EMUReaction", "[", 
             RowBox[{"j_", ",", "e_", ",", "f_", ",", "t_"}], "]"}], 
            "\[Rule]", 
            RowBox[{"EMUReaction", "[", 
             RowBox[{
              RowBox[{"j", "+", "1"}], ",", "e", ",", "f", ",", "t"}], 
             "]"}]}], ",", 
           RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"modify", " ", "metabolite", " ", "exchange"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"metNew", "=", 
         RowBox[{"met", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<Internal\>\"", "\[Rule]", "\"\<Uptake\>\""}], ",", 
            RowBox[{"\"\<Release\>\"", "\[Rule]", "\"\<Free\>\""}]}], 
           "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"erNew", "=", 
         RowBox[{"erNew", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"EMU", "[", 
             RowBox[{"met", ",", "a_"}], "]"}], "\[Rule]", 
            RowBox[{"EMU", "[", 
             RowBox[{"metNew", ",", "a"}], "]"}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"add", " ", "input", " ", "EMU", " ", "reactions"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"metEMUs", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"Cases", "[", 
           RowBox[{"erNew", ",", 
            RowBox[{
             RowBox[{"EMUReaction", "[", 
              RowBox[{"_", ",", "_", ",", 
               RowBox[{"e", ":", 
                RowBox[{"EMU", "[", 
                 RowBox[{"metNew", ",", "_"}], "]"}]}], ",", "_"}], "]"}], 
             "\[Rule]", "e"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"erNew", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"erNew", ",", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"EMUReaction", "[", 
              RowBox[{"jIn", ",", 
               RowBox[{"Replace", "[", 
                RowBox[{"e", ",", 
                 RowBox[{"metNew", "\[Rule]", "metIn"}], ",", 
                 RowBox[{"{", "1", "}"}]}], "]"}], ",", "e", ",", "1"}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"e", ",", "metEMUs"}], "}"}]}], "]"}]}], "]"}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "index", " ", "of", " ", "all", " ", "reactions", " ", "entering", " ", 
       "the", " ", "metabolite"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"jIndex", "=", 
      RowBox[{"Union", "[", 
       RowBox[{"Cases", "[", 
        RowBox[{"erNew", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EMUReaction", "[", 
           RowBox[{"j_", ",", 
            RowBox[{"_EMU", "|", "_Condense"}], ",", 
            RowBox[{"EMU", "[", 
             RowBox[{"metNew", ",", "_"}], "]"}], ",", "_"}], "]"}], 
          "\[Rule]", "j"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "remove", " ", "any", " ", "internal", " ", "EMU", " ", "reactions", 
       " ", "entering", " ", "the", " ", "metabolite"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"erNew", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"erNew", ",", "\[IndentingNewLine]", 
        RowBox[{"EMUReaction", "[", 
         RowBox[{"_", ",", 
          RowBox[{
           RowBox[{"EMU", "[", 
            RowBox[{
             RowBox[{"Metabolite", "[", 
              RowBox[{"_", ",", 
               RowBox[{"Except", "[", "\"\<Input\>\"", "]"}], ",", "_"}], 
              "]"}], ",", "_"}], "]"}], "|", "_Condense"}], ",", 
          RowBox[{"EMU", "[", 
           RowBox[{"metNew", ",", "_"}], "]"}], ",", "_"}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "transfer", " ", "flux", " ", "to", " ", "input", " ", "reaction"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "fluxNew", "\[LeftDoubleBracket]", "jIn", "\[RightDoubleBracket]"}], 
      "=", 
      RowBox[{"Total", "[", 
       RowBox[{
       "fluxNew", "\[LeftDoubleBracket]", "jIndex", "\[RightDoubleBracket]"}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"generate", " ", "substrate", " ", "distributions"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"dist", "=", 
      RowBox[{"Append", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ReplaceAll", "[", 
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{"substrates", ",", 
            RowBox[{"EMU", "[", 
             RowBox[{"metIn", ",", "_"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"e", ":", 
            RowBox[{"EMU", "[", 
             RowBox[{"m_", ",", "__"}], "]"}]}], "\[RuleDelayed]", 
           RowBox[{"Rule", "[", 
            RowBox[{"m", ",", 
             RowBox[{"EmpiricalIsotopomerDistribution", "[", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Table", "[", 
                   RowBox[{"0", ",", 
                    RowBox[{"EMUSize", "[", "e", "]"}]}], "]"}], "}"}], ",", 
                 "1.0"}], "}"}], "}"}], "]"}]}], "]"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Rule", "[", 
         RowBox[{"metIn", ",", 
          RowBox[{"EmpiricalIsotopomerDistribution", "[", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Table", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"Max", "[", 
                  RowBox[{"EMUSize", "/@", "metEMUs"}], "]"}]}], "]"}], "}"}],
               ",", "1.0"}], "}"}], "}"}], "]"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"metNew", ",", "erNew", ",", "fluxNew", ",", "dist"}], 
      "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8749210482035804`*^9, 3.8749212631831193`*^9}, {
   3.874921299050317*^9, 3.874921478282852*^9}, {3.874921596133661*^9, 
   3.874921663855275*^9}, {3.874921729142123*^9, 3.8749217514454403`*^9}, {
   3.8749218044609165`*^9, 3.8749218545550756`*^9}, {3.8749218941311665`*^9, 
   3.874921904164543*^9}, {3.8749219444819536`*^9, 3.8749222140376897`*^9}, {
   3.8749222919591923`*^9, 3.8749223283447*^9}, {3.874922379176411*^9, 
   3.8749224068120346`*^9}, {3.8749224411853423`*^9, 3.87492246240889*^9}, {
   3.8749225272002106`*^9, 3.874922532523156*^9}, {3.8749225706794677`*^9, 
   3.8749226701726246`*^9}, {3.874922707861229*^9, 3.8749227131554394`*^9}, {
   3.874922767597782*^9, 3.874922786312264*^9}, {3.874922939136299*^9, 
   3.8749229464208775`*^9}, {3.8749232375012712`*^9, 3.87492329500977*^9}, {
   3.8749233267198873`*^9, 3.8749233884352603`*^9}, {3.8749235784593525`*^9, 
   3.874923593721936*^9}, {3.8749236762184296`*^9, 3.87492371858519*^9}, {
   3.874923759188724*^9, 3.874923814264695*^9}, 3.874923967519165*^9, {
   3.874924050456992*^9, 3.8749242660234404`*^9}, {3.8749242965897207`*^9, 
   3.8749243869872165`*^9}, {3.8749244286199937`*^9, 3.87492466111339*^9}, {
   3.8749247552991304`*^9, 3.8749247824507637`*^9}, {3.8749248453568363`*^9, 
   3.8749248507606153`*^9}, {3.8749249097142525`*^9, 3.874924933136319*^9}, {
   3.874925039962674*^9, 3.8749250722515907`*^9}, {3.8749251361007814`*^9, 
   3.8749251704149284`*^9}, {3.874925215115121*^9, 3.8749252915260887`*^9}, {
   3.8749253271651115`*^9, 3.8749253580331516`*^9}, 3.874925420689622*^9, {
   3.874925728908126*^9, 3.87492575216775*^9}, {3.8749260213288317`*^9, 
   3.8749260743027205`*^9}, {3.8749261280671206`*^9, 3.874926376858721*^9}, {
   3.874926419190837*^9, 3.8749264226466274`*^9}, {3.8749264601359296`*^9, 
   3.874926557343148*^9}, {3.8749266609736137`*^9, 3.8749267060040827`*^9}, {
   3.875001297677214*^9, 3.8750013671528606`*^9}, {3.8750014050107126`*^9, 
   3.8750014404088755`*^9}, {3.8750014993226953`*^9, 3.875001510901555*^9}, {
   3.875001545347639*^9, 3.875001668979985*^9}, {3.8750018856433*^9, 
   3.875001887891467*^9}, {3.8750034683293934`*^9, 3.875003486841412*^9}, {
   3.8750035631178102`*^9, 3.8750035663664165`*^9}, {3.875004519001712*^9, 
   3.8750045401942835`*^9}, {3.8750045799881744`*^9, 
   3.8750046070894165`*^9}, {3.8750072106395617`*^9, 3.87500723554327*^9}, 
   3.875007279376834*^9, 3.875007349827881*^9, {3.8750074219612417`*^9, 
   3.8750075514068775`*^9}, {3.87500761763227*^9, 3.8750076218601933`*^9}, 
   3.875062501040609*^9, {3.8750635750142765`*^9, 3.8750636198912964`*^9}, {
   3.8750636575210457`*^9, 3.875063668444278*^9}, {3.8750637061406937`*^9, 
   3.8750637187043767`*^9}, {3.8750638426822233`*^9, 
   3.8750638582242017`*^9}, {3.8750639112732*^9, 3.875063946435032*^9}, {
   3.8750640001165915`*^9, 3.8750640356323586`*^9}, {3.875065362532862*^9, 
   3.8750653660590553`*^9}, {3.8750654870906534`*^9, 
   3.8750654878262496`*^9}, {3.875066055672923*^9, 3.8750660653774495`*^9}, 
   3.875066142919595*^9, {3.8750662151296873`*^9, 3.8750662171789055`*^9}, {
   3.8750662847091675`*^9, 3.8750662901853724`*^9}, {3.8750663849908047`*^9, 
   3.875066398616119*^9}, {3.875066449400137*^9, 3.875066477848382*^9}, {
   3.875066583457498*^9, 3.875066615470631*^9}, {3.8750666507741013`*^9, 
   3.875066724131563*^9}, {3.875066786175435*^9, 3.8750667933410645`*^9}, {
   3.8750817811557403`*^9, 3.8750818193400016`*^9}, {3.8750819341980996`*^9, 
   3.87508193458447*^9}, {3.8750819837048798`*^9, 3.8750819992061357`*^9}, 
   3.875082174042285*^9, 3.875083148151481*^9, {3.8750848969092927`*^9, 
   3.875084928392411*^9}, {3.8750851548553667`*^9, 3.8750851734800725`*^9}, 
   3.875085272885925*^9},ExpressionUUID->"1a46c063-6c3c-44b0-b98b-\
79bd01daa786"]
}, Closed]],

Cell[CellGroupData[{

Cell["Compute MID solutions for each metabolite", "Subsection",
 CellChangeTimes->{{3.875062607751605*^9, 3.875062621041667*^9}, {
  3.8750628586966333`*^9, 
  3.875062862393547*^9}},ExpressionUUID->"301d3abe-bd61-4929-8477-\
1440cba4e7dc"],

Cell["This should take about 10 min", "Text",
 CellChangeTimes->{{3.8750658403638377`*^9, 
  3.875065846748725*^9}},ExpressionUUID->"ad03368a-d58f-4ac2-bcc0-\
80ee758ab301"],

Cell[BoxData[
 RowBox[{
  RowBox[{"carbonFateMids", "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "metNew", ",", "er", ",", "flux", ",", "subDist", ",", "emuEq", ",", 
       "inputRules", ",", "emuSol"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"metNew", ",", "er", ",", "flux", ",", "subDist"}], "}"}], 
         "=", 
         RowBox[{"MutateNetwork", "[", 
          RowBox[{
          "net", ",", "\[IndentingNewLine]", "met", ",", "emuReactions", ",", 
           RowBox[{
            RowBox[{"EMUFluxMap", "[", "net", "]"}], "[", "trueFlux", "]"}], 
           ",", "substrates"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"emuEq", "=", 
         RowBox[{"EMUSystem", "[", 
          RowBox[{"er", ",", 
           RowBox[{"Length", "[", "flux", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"inputRules", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Rule", "[", 
            RowBox[{"e", ",", 
             RowBox[{"EMUMassIsotopomerDistribution", "[", 
              RowBox[{"e", ",", 
               RowBox[{
                RowBox[{"Metabolite", "[", "e", "]"}], "/.", "subDist"}]}], 
              "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"e", ",", 
             RowBox[{"Flatten", "[", 
              RowBox[{"SubstrateEMUs", "/@", "emuEq"}], "]"}]}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"emuSol", "=", 
         RowBox[{"EMUSimulate", "[", 
          RowBox[{"emuEq", ",", "inputRules", ",", "flux"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"get", " ", "all", " ", "MIDs"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"emuSol", "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MetaboliteEMUs", "[", "atomMap", "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{"met", "\[Rule]", "metNew"}], "}"}]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"met", ",", 
         RowBox[{"Metabolite", "/@", 
          RowBox[{"MetaboliteEMUs", "[", "atomMap", "]"}]}]}], "}"}]}], 
      "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8750626469442277`*^9, 3.8750629258090115`*^9}, {
   3.8750630243299823`*^9, 3.8750630613831053`*^9}, {3.875063158272189*^9, 
   3.8750631935536685`*^9}, {3.875063396485959*^9, 3.87506340106569*^9}, {
   3.875063447165556*^9, 3.8750634545162106`*^9}, {3.875064211702917*^9, 
   3.875064218907299*^9}, {3.8750642529610996`*^9, 3.8750643045863705`*^9}, {
   3.8750643672911386`*^9, 3.875064376142257*^9}, {3.87506447212687*^9, 
   3.875064482250572*^9}, {3.875064534481292*^9, 3.875064535214259*^9}, {
   3.875064628357875*^9, 3.8750646364672265`*^9}, {3.875064684150877*^9, 
   3.875064709274149*^9}, {3.875064816588146*^9, 3.8750648881574316`*^9}, {
   3.875064919833627*^9, 3.875064971010598*^9}, {3.875065095341996*^9, 
   3.875065112428258*^9}, 3.8750651858309474`*^9, {3.87506531986401*^9, 
   3.875065328160187*^9}, {3.8750654982834387`*^9, 3.875065524980249*^9}, {
   3.875065753908414*^9, 3.875065835162959*^9}, 3.8750659865637045`*^9, 
   3.875066780372081*^9, {3.8750705565326233`*^9, 3.8750705790647717`*^9}, {
   3.8750710361741414`*^9, 3.8750710460820293`*^9}, {3.875079492225073*^9, 
   3.8750794956733117`*^9}, 3.8750839748162794`*^9, {3.941864116193283*^9, 
   3.941864192323433*^9}},ExpressionUUID->"db12dd02-ee07-4a18-a44c-\
6b480005d86b"],

Cell[BoxData[
 RowBox[{"Length", "[", "carbonFateMids", "]"}]], "Input",
 CellChangeTimes->{{3.941864929782378*^9, 
  3.9418649322230616`*^9}},ExpressionUUID->"4182cef5-bd85-4344-a7fa-\
df27de3e2c65"]
}, Closed]],

Cell[CellGroupData[{

Cell["Compute fraction-derived matrix", "Subsection",
 CellChangeTimes->{{3.8750840220181055`*^9, 3.8750840249203854`*^9}, {
  3.94186514688297*^9, 
  3.94186514955275*^9}},ExpressionUUID->"03eeac76-3583-4dca-bf36-\
2adb39eaec75"],

Cell["\<\
Rows correspond to labeled substrates, columns to metabolite products, so \
matrix element (i,j) is the fraction of metabolite j derived from metabolite \
i.\
\>", "Text",
 CellChangeTimes->{{3.8750840352866535`*^9, 3.875084054735982*^9}, {
  3.94186430220008*^9, 3.94186432598304*^9}, {3.9418651703528385`*^9, 
  3.9418651992325277`*^9}},ExpressionUUID->"a942b468-5060-46e9-8975-\
447398604a19"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fractionDerived", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"MIDEnrichment", ",", "carbonFateMids", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "fractionDerived", "]"}]}], "Input",
 CellChangeTimes->{{3.8750840620592227`*^9, 3.87508407630672*^9}, 
   3.941864946002706*^9, {3.941865159282439*^9, 
   3.9418651647623625`*^9}},ExpressionUUID->"588d434a-f230-4f32-ac7c-\
b5fd582fa086"],

Cell["Verify diagonal is 1", "Text",
 CellChangeTimes->{{3.875086151884943*^9, 3.8750861549719543`*^9}, {
  3.941865093932949*^9, 
  3.941865099742979*^9}},ExpressionUUID->"7e57e204-5825-4ee9-819c-\
5028631a715a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Union", "[", 
   RowBox[{"Diagonal", "[", "fractionDerived", "]"}], "]"}], "\[Equal]", 
  RowBox[{"{", "1", "}"}]}]], "Input",
 CellChangeTimes->{{3.8750845876904945`*^9, 3.875084589166217*^9}, {
   3.8750861416633043`*^9, 3.875086149302868*^9}, 
   3.9418652160923767`*^9},ExpressionUUID->"a2f074d4-8fc6-454c-9ffc-\
936d1133cc3c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Export matrix", "Subsection",
 CellChangeTimes->{{3.875084305232212*^9, 3.8750843090491343`*^9}, {
  3.875084375122639*^9, 3.875084375880138*^9}, {3.9418651257427406`*^9, 
  3.9418651264422092`*^9}},ExpressionUUID->"b5954837-3ed6-4017-977d-\
0ac5b6683bc8"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", "metNames", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"metNames", "=", 
     RowBox[{"MetaboliteShortName", "/@", 
      RowBox[{"Metabolite", "/@", 
       RowBox[{"MetaboliteEMUs", "[", "atomMap", "]"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<fraction-derived-matrix.tsv\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{"ArrayFlatten", "[", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", "\"\<\>\"", "}"}], "}"}], ",", 
           RowBox[{"{", "metNames", "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", "metNames", "}"}], "]"}], ",", "fractionDerived"}], 
          "}"}]}], "}"}], "]"}]}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8750843933468246`*^9, 3.875084419699433*^9}, {
   3.875084456030006*^9, 3.8750845390635147`*^9}, 
   3.941865225506807*^9},ExpressionUUID->"07565a13-a8df-4400-9270-\
c2b886b828a8"]
}, Closed]]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->None,
WindowSize->{1564, 2024},
WindowMargins->{{4, Automatic}, {Automatic, 7}},
ShowSelection->True,
Magnification:>1.4 Inherited,
FrontEndVersion->"11.1 for Microsoft Windows (64-bit) (April 18, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[422, 15, 1030, 15, 141, "Title", "ExpressionUUID" -> \
"a07bb2d6-24fa-41bf-8eb9-97e0b44fe4ff"],
Cell[1455, 32, 490, 11, 73, "Text", "ExpressionUUID" -> \
"1000efa5-1f1f-48df-9f9b-844d7613cbc0"],
Cell[1948, 45, 557, 12, 43, "Input", "ExpressionUUID" -> \
"5f956496-50c3-4d34-971c-99c6e8f7822b"],
Cell[2508, 59, 452, 9, 43, "Input", "ExpressionUUID" -> \
"55123894-b5b4-4dd1-997b-583292c9f222"],
Cell[2963, 70, 1198, 18, 184, "Input", "ExpressionUUID" -> \
"8b0b154a-4f30-41a5-abf8-1c38f42be304"],
Cell[4164, 90, 234, 5, 43, "Input", "ExpressionUUID" -> \
"f189ba21-c51a-4651-9218-17a62979063f"],
Cell[4401, 97, 166, 3, 43, "Text", "ExpressionUUID" -> \
"c1c31270-c7db-40c1-a52a-4b84fe32b3ea"],
Cell[4570, 102, 283, 6, 43, "Input", "ExpressionUUID" -> \
"9cf77950-7f2b-4e24-8108-ead026b859cd"],
Cell[CellGroupData[{
Cell[4878, 112, 316, 5, 96, "Section", "ExpressionUUID" -> \
"2f4a18e5-4034-4422-b0f1-f8412fd3800b"],
Cell[CellGroupData[{
Cell[5219, 121, 163, 3, 67, "Subsection", "ExpressionUUID" -> \
"79ec9a5b-981d-4a78-8d76-b29d23428ca0"],
Cell[5385, 126, 1316, 23, 100, "Input", "ExpressionUUID" -> \
"7b6809bc-9800-4f4f-919f-24a12b2bcbd6"],
Cell[6704, 151, 318, 6, 60, "Text", "ExpressionUUID" -> \
"f3894926-7f38-4527-b76d-235106db43fc"],
Cell[7025, 159, 735, 12, 60, "Input", "ExpressionUUID" -> \
"d48b3d7a-f082-4229-9555-364c3266b73d"],
Cell[7763, 173, 300, 4, 60, "Text", "ExpressionUUID" -> \
"fd2e36ff-f5d6-48ab-aa14-d841b44dd110"],
Cell[8066, 179, 226, 5, 60, "Input", "ExpressionUUID" -> \
"af19f68d-caaf-4bbc-8024-81baccbf7602"]
}, Closed]],
Cell[CellGroupData[{
Cell[8329, 189, 176, 3, 54, "Subsection", "ExpressionUUID" -> \
"a0e55e63-87c3-479e-9da8-c84b873d810e"],
Cell[8508, 194, 736, 12, 60, "Input", "ExpressionUUID" -> \
"9632d601-8a30-4136-aa32-df8e27fe21a3"]
}, Closed]],
Cell[CellGroupData[{
Cell[9281, 211, 237, 4, 54, "Subsection", "ExpressionUUID" -> \
"8b2a8203-ec6f-4804-8abe-8752b241526f"],
Cell[9521, 217, 242, 4, 60, "Text", "ExpressionUUID" -> \
"b825bfa5-82f8-4840-bf38-03aef6e19d37"],
Cell[9766, 223, 1372, 23, 100, "Input", "ExpressionUUID" -> \
"35a9a7cd-c087-47a6-8351-a42e49099765"],
Cell[11141, 248, 322, 5, 60, "Text", "ExpressionUUID" -> \
"6acea234-a9f6-41bb-be72-3184d8acd39d"],
Cell[11466, 255, 428, 9, 100, "Input", "ExpressionUUID" -> \
"68ddcf95-54b3-4244-a167-390f83de996f"],
Cell[11897, 266, 160, 3, 60, "Text", "ExpressionUUID" -> \
"5b095489-0c26-4fe3-bc8a-b7d4e76c367a"],
Cell[12060, 271, 1392, 23, 100, "Input", "ExpressionUUID" -> \
"1f3cd015-2c36-4f3f-8025-90299c18d849"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[13501, 300, 156, 3, 96, "Section", "ExpressionUUID" -> \
"235fc02c-358b-4b95-bdb0-d0a9b151526d"],
Cell[CellGroupData[{
Cell[13682, 307, 405, 6, 67, "Subsection", "ExpressionUUID" -> \
"2b11aa43-83ea-4e3a-ac86-f139f39a3f7f"],
Cell[14090, 315, 165, 3, 60, "Text", "ExpressionUUID" -> \
"e61e5192-7f4b-4645-812c-5e7e602942c5"],
Cell[14258, 320, 369, 9, 100, "Input", "ExpressionUUID" -> \
"faab4f84-fa29-462f-9b7d-cf2660af64e6"]
}, Closed]],
Cell[CellGroupData[{
Cell[14664, 334, 210, 3, 54, "Subsection", "ExpressionUUID" -> \
"6547c4ec-5522-4f3a-86ea-c0ffc79166a5"],
Cell[14877, 339, 368, 7, 60, "Text", "ExpressionUUID" -> \
"379137ff-dc14-4205-b45d-592081a55b1d"],
Cell[15248, 348, 1088, 19, 100, "Input", "ExpressionUUID" -> \
"0e6de91d-7580-4089-9105-3c7816650b76"],
Cell[16339, 369, 521, 11, 100, "Input", "ExpressionUUID" -> \
"e4e68454-3b63-47e2-a2ef-958f855aa2cd"],
Cell[16863, 382, 158, 3, 60, "Text", "ExpressionUUID" -> \
"fefd05f6-4e78-4fa9-a2de-1e55f0509be7"],
Cell[17024, 387, 610, 15, 100, "Input", "ExpressionUUID" -> \
"53ee85b9-e9ef-4b7e-a436-a36357f575f7"],
Cell[17637, 404, 224, 4, 60, "Text", "ExpressionUUID" -> \
"ee276756-cdfb-48ce-b2e3-bbcac68fc405"],
Cell[17864, 410, 278, 6, 60, "Input", "ExpressionUUID" -> \
"0dbec32c-364f-4ffe-9b18-20fb8045a343"],
Cell[18145, 418, 296, 4, 60, "Text", "ExpressionUUID" -> \
"b3c187ec-861a-44d3-b0ee-3af35ee335f1"],
Cell[18444, 424, 511, 14, 60, "Input", "ExpressionUUID" -> \
"b8a67b6f-4d0f-4e5d-960d-b1c9e4882d60"],
Cell[18958, 440, 153, 3, 60, "Text", "ExpressionUUID" -> \
"31e464ac-6956-485d-ba38-c9d0b797cc43"],
Cell[19114, 445, 292, 7, 60, "Input", "ExpressionUUID" -> \
"b3d0c2a6-3a05-48cf-b50e-6a99f194dcd9"]
}, Closed]],
Cell[CellGroupData[{
Cell[19443, 457, 256, 4, 54, "Subsection", "ExpressionUUID" -> \
"43c72176-d331-4d6c-b081-b73788094d4a"],
Cell[19702, 463, 1047, 19, 60, "Input", "ExpressionUUID" -> \
"3291fa11-04c5-44a7-a5d0-739669a6e8f3"],
Cell[20752, 484, 265, 6, 60, "Input", "ExpressionUUID" -> \
"aa60d42c-a34f-412d-827c-6479bf45e95c"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[21066, 496, 426, 6, 96, "Section", "ExpressionUUID" -> \
"a6538c06-62b2-4eb9-b2a0-ff935b012d35"],
Cell[CellGroupData[{
Cell[21517, 506, 176, 3, 67, "Subsection", "ExpressionUUID" -> \
"63558677-2c91-4a59-afff-95f3941aaab6"],
Cell[21696, 511, 495, 13, 43, "Input", "ExpressionUUID" -> \
"8acf436b-74c6-4ee1-85ea-fad4be2c5a50"],
Cell[22194, 526, 268, 6, 43, "Input", "ExpressionUUID" -> \
"59d71ad3-7983-4557-a6dc-5a51f3d24e43"],
Cell[22465, 534, 297, 7, 43, "Text", "ExpressionUUID" -> \
"1f0bbbe0-24df-452f-8b93-81c22675cd9b"],
Cell[22765, 543, 783, 17, 72, "Input", "ExpressionUUID" -> \
"0d383652-ef1b-4fd7-ae2e-7c3491b5b828"],
Cell[23551, 562, 483, 9, 43, "Input", "ExpressionUUID" -> \
"c1e4747b-ca2d-4b78-8a7d-89a80c23ea34"]
}, Closed]],
Cell[CellGroupData[{
Cell[24071, 576, 273, 6, 54, "Subsection", "ExpressionUUID" -> \
"d9d9a521-1ee1-4ad0-a883-ded6de44cf75"],
Cell[24347, 584, 451, 9, 60, "Text", "ExpressionUUID" -> \
"a7891750-0815-4df8-9504-814250ec694f"],
Cell[24801, 595, 2658, 57, 296, "Input", "ExpressionUUID" -> \
"a5e41789-b769-4f28-898a-709388a8ac9f"]
}, Closed]],
Cell[CellGroupData[{
Cell[27496, 657, 191, 3, 54, "Subsection", "ExpressionUUID" -> \
"ee0c7240-960e-4e82-8380-e0110d86151b"],
Cell[27690, 662, 758, 18, 140, "Input", "ExpressionUUID" -> \
"a7df903a-e10d-40cb-bb56-32c97a030b0f"],
Cell[28451, 682, 393, 8, 60, "Text", "ExpressionUUID" -> \
"3d456ce1-9a98-4858-99c7-88cc1eb80b19"],
Cell[28847, 692, 1854, 46, 375, "Input", "ExpressionUUID" -> \
"01382e02-d766-4fb5-8ccc-12a44ad0f846"],
Cell[30704, 740, 180, 3, 60, "Text", "ExpressionUUID" -> \
"085ab0c0-6d3b-4073-8269-f46306059027"],
Cell[30887, 745, 1276, 29, 218, "Input", "ExpressionUUID" -> \
"7820f5e8-d24b-44e7-b124-e70a16697a16"],
Cell[32166, 776, 233, 4, 60, "Text", "ExpressionUUID" -> \
"307efc3e-7a29-4465-b579-c99681a382e4"],
Cell[32402, 782, 572, 17, 60, "Input", "ExpressionUUID" -> \
"a7fdf6a2-2b1b-4d8f-8df3-28927f09ee6e"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[33023, 805, 355, 5, 96, "Section", "ExpressionUUID" -> \
"34e55f2d-6d53-4f83-b34c-c3fb37746f9c"],
Cell[CellGroupData[{
Cell[33403, 814, 161, 3, 67, "Subsection", "ExpressionUUID" -> \
"c5824257-c971-46bf-8cb6-f3c315b2038b"],
Cell[33567, 819, 271, 4, 60, "Text", "ExpressionUUID" -> \
"00283386-4d2c-46f9-8f67-c8d2bc8ce316"],
Cell[33841, 825, 745, 17, 140, "Input", "ExpressionUUID" -> \
"5cd4227d-46d5-4080-a020-3285800e4fb0"],
Cell[34589, 844, 190, 4, 60, "Input", "ExpressionUUID" -> \
"ffbb62ac-b134-42ed-8d5b-1402e8c8643f"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[34828, 854, 169, 3, 96, "Section", "ExpressionUUID" -> \
"bb0f1596-2bb7-42dc-8b6e-10c08769bace"],
Cell[35000, 859, 412, 8, 71, "Text", "ExpressionUUID" -> \
"6b548ce2-3d8a-4a52-b650-18944b63897e"],
Cell[35415, 869, 496, 7, 43, "Text", "ExpressionUUID" -> \
"fb974e80-e0ae-47b1-95d3-5758bc620ce0"],
Cell[35914, 878, 653, 18, 45, "Text", "ExpressionUUID" -> \
"7b139b41-533e-43e5-af5b-93ff6af66754"],
Cell[36570, 898, 1014, 22, 72, "Text", "ExpressionUUID" -> \
"376508f4-f273-4e2d-8fec-0fe98132963f"],
Cell[CellGroupData[{
Cell[37609, 924, 237, 4, 67, "Subsection", "ExpressionUUID" -> \
"0a82fada-cce4-4281-a157-444c477690e5"],
Cell[37849, 930, 220, 4, 60, "Text", "ExpressionUUID" -> \
"3d647635-8a1d-4a26-ab0b-54bc344f34a5"],
Cell[38072, 936, 600, 13, 60, "Input", "ExpressionUUID" -> \
"d73bf8a9-e225-4d6f-a3dc-8fa4064a883d"],
Cell[38675, 951, 197, 3, 60, "Text", "ExpressionUUID" -> \
"676900c1-2cd6-4456-9d2e-06fb0e59503a"],
Cell[38875, 956, 1124, 26, 179, "Input", "ExpressionUUID" -> \
"71f750ca-300e-4381-a007-4d61fd61079e"],
Cell[40002, 984, 315, 8, 61, "Text", "ExpressionUUID" -> \
"a116b6fa-b399-4405-b744-6dd3bc92b98b"],
Cell[40320, 994, 913, 26, 140, "Input", "ExpressionUUID" -> \
"0678590c-74f7-4fd1-958e-11db98b33fa6"],
Cell[41236, 1022, 163, 3, 60, "Text", "ExpressionUUID" -> \
"f3fb4437-8841-474e-bd3d-78c45ecb8725"],
Cell[41402, 1027, 654, 11, 60, "Input", "ExpressionUUID" -> \
"673ff5a9-8da4-4fd3-beb7-5ab335e6266c"]
}, Closed]],
Cell[CellGroupData[{
Cell[42093, 1043, 254, 4, 54, "Subsection", "ExpressionUUID" -> \
"3d9ef832-789f-4b66-9e77-1f31cfa99f89"],
Cell[42350, 1049, 221, 5, 60, "Text", "ExpressionUUID" -> \
"6177001d-744b-4c06-ace4-affb4d4d392b"],
Cell[42574, 1056, 1898, 41, 257, "Input", "ExpressionUUID" -> \
"0e84f7d1-90c6-494f-b826-928c36f7862c"],
Cell[44475, 1099, 268, 7, 60, "Input", "ExpressionUUID" -> \
"a138e73f-81b4-4d69-804d-6d59ffd85b9c"]
}, Closed]],
Cell[CellGroupData[{
Cell[44780, 1111, 193, 3, 54, "Subsection", "ExpressionUUID" -> \
"2e5f8c3c-efca-4bbd-890d-299fde2bd61c"],
Cell[44976, 1116, 227, 4, 60, "Text", "ExpressionUUID" -> \
"75204b8d-e451-4644-af5f-b3d1fc3478c9"],
Cell[45206, 1122, 258, 7, 60, "Input", "ExpressionUUID" -> \
"c3eaaed1-f68a-4641-ab26-80292ba76e26"],
Cell[45467, 1131, 3339, 59, 375, "Input", "ExpressionUUID" -> \
"f7578180-10a7-4296-8ea5-77b324542fb1"]
}, Closed]],
Cell[CellGroupData[{
Cell[48843, 1195, 229, 4, 54, "Subsection", "ExpressionUUID" -> \
"c8d71cb4-1ed2-405d-bc59-61fbe154dbba"],
Cell[49075, 1201, 592, 16, 60, "Input", "ExpressionUUID" -> \
"fec4f722-ab23-46ca-b936-5030c1319026"],
Cell[49670, 1219, 228, 4, 60, "Text", "ExpressionUUID" -> \
"2ed58c96-0af3-4c0c-a763-addd6287e9d6"],
Cell[49901, 1225, 3289, 66, 296, "Input", "ExpressionUUID" -> \
"6d2d9943-5899-47b4-a894-5ed0f16b3555"]
}, Closed]],
Cell[CellGroupData[{
Cell[53227, 1296, 401, 6, 54, "Subsection", "ExpressionUUID" -> \
"d25168b2-74ee-44e5-8219-559d9f1274c2"],
Cell[53631, 1304, 506, 14, 100, "Input", "ExpressionUUID" -> \
"a407dea2-9537-4cd0-8514-1472f1a2f416"],
Cell[54140, 1320, 3452, 66, 140, "Input", "ExpressionUUID" -> \
"66378574-a343-437e-8e0e-f5256424b894"],
Cell[57595, 1388, 2360, 41, 140, "Input", "ExpressionUUID" -> \
"7a0441f6-c29e-4036-b386-9ca59188ef0c"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[60004, 1435, 221, 4, 96, "Section", "ExpressionUUID" -> \
"ca830aa5-a702-479a-9176-27ca8d8bfb66"],
Cell[60228, 1441, 367, 7, 43, "Text", "ExpressionUUID" -> \
"b7c26c83-9055-482a-a484-1731a51f92c6"],
Cell[60598, 1450, 1322, 34, 156, "Input", "ExpressionUUID" -> \
"cee4efc0-21d0-4079-9f2d-f69f31093925"],
Cell[61923, 1486, 203, 4, 43, "Input", "ExpressionUUID" -> \
"7af0110b-6e9e-44d6-af74-f07b463b4f3b"],
Cell[62129, 1492, 181, 3, 43, "Text", "ExpressionUUID" -> \
"670bd425-a2f0-44ec-a542-7f4af12afec0"],
Cell[62313, 1497, 1890, 51, 184, "Input", "ExpressionUUID" -> \
"73b2b41b-fc2e-4403-9085-b1cba46f9abb"],
Cell[64206, 1550, 274, 7, 43, "Input", "ExpressionUUID" -> \
"88878906-0475-434f-8f93-7859157b27a1"],
Cell[64483, 1559, 612, 11, 43, "Input", "ExpressionUUID" -> \
"4d3b1c2e-c760-4c89-a3cd-6cbb00dda818"]
}, Closed]],
Cell[CellGroupData[{
Cell[65132, 1575, 241, 4, 75, "Section", "ExpressionUUID" -> \
"384aab85-fe18-49a0-bc7a-3e434f099d82"],
Cell[CellGroupData[{
Cell[65398, 1583, 229, 4, 67, "Subsection", "ExpressionUUID" -> \
"06d7e0e4-7ce9-487d-8391-302a6250917e"],
Cell[65630, 1589, 699, 15, 73, "Text", "ExpressionUUID" -> \
"ca253f2c-87b1-413c-a388-31d04741d0bb"],
Cell[66332, 1606, 13373, 284, 1166, "Input", "ExpressionUUID" -> \
"1a46c063-6c3c-44b0-b98b-79bd01daa786"]
}, Closed]],
Cell[CellGroupData[{
Cell[79742, 1895, 240, 4, 54, "Subsection", "ExpressionUUID" -> \
"301d3abe-bd61-4929-8477-1440cba4e7dc"],
Cell[79985, 1901, 173, 3, 43, "Text", "ExpressionUUID" -> \
"ad03368a-d58f-4ac2-bcc0-80ee758ab301"],
Cell[80161, 1906, 3697, 78, 352, "Input", "ExpressionUUID" -> \
"db12dd02-ee07-4a18-a44c-6b480005d86b"],
Cell[83861, 1986, 200, 4, 43, "Input", "ExpressionUUID" -> \
"4182cef5-bd85-4344-a7fa-df27de3e2c65"]
}, Closed]],
Cell[CellGroupData[{
Cell[84098, 1995, 230, 4, 54, "Subsection", "ExpressionUUID" -> \
"03eeac76-3583-4dca-bf36-2adb39eaec75"],
Cell[84331, 2001, 406, 8, 43, "Text", "ExpressionUUID" -> \
"a942b468-5060-46e9-8975-447398604a19"],
Cell[84740, 2011, 480, 10, 72, "Input", "ExpressionUUID" -> \
"588d434a-f230-4f32-ac7c-b5fd582fa086"],
Cell[85223, 2023, 213, 4, 43, "Text", "ExpressionUUID" -> \
"7e57e204-5825-4ee9-819c-5028631a715a"],
Cell[85439, 2029, 366, 8, 43, "Input", "ExpressionUUID" -> \
"a2f074d4-8fc6-454c-9ffc-936d1133cc3c"]
}, Closed]],
Cell[CellGroupData[{
Cell[85842, 2042, 262, 4, 54, "Subsection", "ExpressionUUID" -> \
"b5954837-3ed6-4017-977d-0ac5b6683bc8"],
Cell[86107, 2048, 1179, 30, 184, "Input", "ExpressionUUID" -> \
"07565a13-a8df-4400-9270-c2b886b828a8"]
}, Closed]]
}, Open  ]]
}, Open  ]]
}
]
*)

